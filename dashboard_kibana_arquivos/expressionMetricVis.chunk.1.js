(window.expressionMetricVis_bundle_jsonpfunction=window.expressionMetricVis_bundle_jsonpfunction||[]).push([[1],[,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n,o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),s=[];function a(t){for(var e=-1,r=0;r<s.length;r++)if(s[r].identifier===t){e=r;break}return e}function c(t,e){for(var r={},n=[],o=0;o<t.length;o++){var i=t[o],c=e.base?i[0]+e.base:i[0],l=r[c]||0,u="".concat(c," ").concat(l);r[c]=l+1;var p=a(u),d={css:i[1],media:i[2],sourceMap:i[3]};-1!==p?(s[p].references++,s[p].updater(d)):s.push({identifier:u,updater:v(d,e),references:1}),n.push(u)}return n}function l(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var o=r.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var s=i(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var u,p=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function d(t,e,r,n){var o=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=p(e,o);else{var i=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(i,s[e]):t.appendChild(i)}}function f(t,e,r){var n=r.css,o=r.media,i=r.sourceMap;if(o?t.setAttribute("media",o):t.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var m=null,h=0;function v(t,e){var r,n,o;if(e.singleton){var i=h++;r=m||(m=l(e)),n=d.bind(null,r,i,!1),o=d.bind(null,r,i,!0)}else r=l(e),n=f.bind(null,r,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=o());var r=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<r.length;n++){var o=a(r[n]);s[o].references--}for(var i=c(t,e),l=0;l<r.length;l++){var u=a(r[l]);0===s[u].references&&(s[u].updater(),s.splice(u,1))}r=i}}}},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var o=(s=n,a=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),i=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[r].concat(i).concat([o]).join("\n")}var s,a,c;return[r].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,n){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(n)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(o[s]=!0)}for(var a=0;a<t.length;a++){var c=[].concat(t[a]);n&&o[c[0]]||(r&&(c[2]?c[2]="".concat(r," and ").concat(c[2]):c[2]=r),e.push(c))}},e}},function(t,e,r){t.exports=r(12)(1073)},function(t,e,r){switch(window.__kbnThemeTag__){case"v7dark":return r(21);case"v7light":return r(23);case"v8dark":return r(25);case"v8light":return r(27)}},function(t,e,r){var n=r(17),o=r(22);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);t.exports=o.locals||{}},function(t,e,r){(e=r(18)(!1)).push([t.i,".mtrVis{width:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;flex-wrap:wrap}.mtrVis__value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-weight:700}.mtrVis__container{text-align:center;padding:16px}.mtrVis__container--light{color:#1D1E24}.mtrVis__container-isFilterable{cursor:pointer;transition:transform 250ms cubic-bezier(0.694, 0.0482, 0.335, 1);transform:translate(0, 0)}.mtrVis__container-isFilterable:hover,.mtrVis__container-isFilterable:focus{box-shadow:none;transform:translate(0, -2px)}\n",""]),t.exports=e},function(t,e,r){var n=r(17),o=r(24);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);t.exports=o.locals||{}},function(t,e,r){(e=r(18)(!1)).push([t.i,".mtrVis{width:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;flex-wrap:wrap}.mtrVis__value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-weight:700}.mtrVis__container{text-align:center;padding:16px}.mtrVis__container--light{color:#fff}.mtrVis__container-isFilterable{cursor:pointer;transition:transform 250ms cubic-bezier(0.694, 0.0482, 0.335, 1);transform:translate(0, 0)}.mtrVis__container-isFilterable:hover,.mtrVis__container-isFilterable:focus{box-shadow:none;transform:translate(0, -2px)}\n",""]),t.exports=e},function(t,e,r){var n=r(17),o=r(26);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);t.exports=o.locals||{}},function(t,e,r){(e=r(18)(!1)).push([t.i,".mtrVis{width:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;flex-wrap:wrap}.mtrVis__value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-weight:700}.mtrVis__container{text-align:center;padding:16px}.mtrVis__container--light{color:#1D1E24}.mtrVis__container-isFilterable{cursor:pointer;transition:transform 250ms cubic-bezier(0.694, 0.0482, 0.335, 1);transform:translate(0, 0)}.mtrVis__container-isFilterable:hover,.mtrVis__container-isFilterable:focus{box-shadow:none;transform:translate(0, -2px)}\n",""]),t.exports=e},function(t,e,r){var n=r(17),o=r(28);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);t.exports=o.locals||{}},function(t,e,r){(e=r(18)(!1)).push([t.i,".mtrVis{width:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;flex-wrap:wrap}.mtrVis__value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-weight:700}.mtrVis__container{text-align:center;padding:16px}.mtrVis__container--light{color:#fff}.mtrVis__container-isFilterable{cursor:pointer;transition:transform 250ms cubic-bezier(0.694, 0.0482, 0.335, 1);transform:translate(0, 0)}.mtrVis__container-isFilterable:hover,.mtrVis__container-isFilterable:focus{box-shadow:none;transform:translate(0, -2px)}\n",""]),t.exports=e},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return metric_component_MetricVisComponent}));var n=r(19),o=r.n(n),i=r(13),s=r(4),a=r(14),c=r(15),l=r.n(c),u=r(2);const p=({fontSize:t,metric:e,onFilter:r,showLabel:n})=>{const o=l()("mtrVis__container",{"mtrVis__container--light":e.lightText,"mtrVis__container-isfilterable":r}),i=Object(u.jsx)("div",{className:o,style:{backgroundColor:e.bgColor}},Object(u.jsx)("div",{className:"mtrVis__value",style:{fontSize:`${t}pt`,color:e.color},dangerouslySetInnerHTML:{__html:e.value}}),n&&Object(u.jsx)("div",null,e.label));return r?Object(u.jsx)("button",{style:{display:"block"},onClick:()=>r(e)},i):i};var d=r(16),f=r(5);r(20);class metric_component_MetricVisComponent extends s.Component{constructor(...t){super(...t),o()(this,"getFormattedValue",((t,e,r="text")=>Object(i.isNaN)(e)?"-":t.convert(e,r))),o()(this,"filterBucket",(t=>{const e=this.props.visParams.dimensions;if(!e.bucket)return;const r=this.props.visData;this.props.fireEvent({name:"filterBucket",data:{data:[{table:r,column:e.bucket.accessor,row:t.rowIndex}]}})})),o()(this,"renderMetric",((t,e)=>Object(u.jsx)(p,{key:e,metric:t,fontSize:this.props.visParams.metric.style.fontSize,onFilter:this.props.visParams.dimensions.bucket?this.filterBucket:void 0,showLabel:this.props.visParams.metric.labels.show})))}getLabels(){var t,e;const r=this.props.visParams.metric,n=r.percentageMode,o=r.colorsRange,s=null!==(t=null===(e=Object(i.last)(o))||void 0===e?void 0:e.to)&&void 0!==t?t:1,a=[];return o.forEach((t=>{const e=n?Math.round(100*t.from/s):t.from,r=n?Math.round(100*t.to/s):t.to;a.push(`${e} - ${r}`)})),a}getColors(){const t=this.props.visParams.metric,e=t.invertColors,r=t.colorSchema,n=t.colorsRange,o=this.getLabels(),i={};for(let t=0;t<o.length;t+=1){const s=Math.max(n.length-1,1),a=e?1-t/s:t/s;i[o[t]]=Object(d.getHeatmapColors)(a,r)}return i}getBucket(t){const e=this.props.visParams.metric;let r=Object(i.findIndex)(e.colorsRange,(e=>e.from<=t&&e.to>t));var n,o;-1===r&&(r=null!==(n=e.colorsRange)&&void 0!==n&&n[0]&&t<(null===(o=e.colorsRange)||void 0===o?void 0:o[0].from)?0:e.colorsRange.length-1);return r}getColor(t,e,r){return r[e[this.getBucket(t)]]}needsLightText(t){const e=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(t);if(!e)return!1;const[r,n,o]=e.slice(1).map((t=>parseInt(t,10)));return Object(a.isColorDark)(r,n,o)}getColumn(t,e=[]){return"number"==typeof t?e[t]:e.filter((({id:e})=>t.id===e))[0]}processTableGroups(t){var e,r;const{metric:n,dimensions:o}=this.props.visParams,{percentageMode:s,colorsRange:a,style:c}=n,l=null==a||null===(e=a[0])||void 0===e?void 0:e.from,u=null===(r=Object(i.last)(a))||void 0===r?void 0:r.to,p=this.getColors(),d=this.getLabels(),m=[];let h,v;return o.bucket&&(h=this.getColumn(o.bucket.accessor,t.columns).id,v=Object(f.a)().deserialize(o.bucket.format)),o.metrics.forEach((e=>{const r=this.getColumn(e.accessor,null==t?void 0:t.columns),n=Object(f.a)().deserialize(e.format);t.rows.forEach(((t,e)=>{let o=r.name,i=t[r.id];const f=this.getColor(i,d,p);s&&null!=a&&a.length&&void 0!==u&&void 0!==l&&(i=(i-l)/(u-l));const g=this.getFormattedValue(n,i,"html");if(h){o=`${this.getFormattedValue(v,t[h])} - ${o}`}const b=a&&a.length>1;m.push({label:o,value:g,color:b&&c.labelColor?f:void 0,bgColor:b&&c.bgColor?f:void 0,lightText:b&&c.bgColor&&this.needsLightText(f),rowIndex:e})}))})),m}componentDidMount(){this.props.renderComplete()}componentDidUpdate(){this.props.renderComplete()}render(){let t;if(this.props.visData){t=this.processTableGroups(this.props.visData).map(this.renderMetric)}return t}}}]]);