(window.visDefaultEditor_bundle_jsonpfunction=window.visDefaultEditor_bundle_jsonpfunction||[]).push([[1],Array(24).concat([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(19).__importDefault(i(28));t.default=function(e){a.default((function(){e()}))}},function(e,t,i){"use strict";var a,r=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},n=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),o=[];function s(e){for(var t=-1,i=0;i<o.length;i++)if(o[i].identifier===e){t=i;break}return t}function l(e,t){for(var i={},a=[],r=0;r<e.length;r++){var n=e[r],l=t.base?n[0]+t.base:n[0],d=i[l]||0,c="".concat(l," ").concat(d);i[l]=d+1;var u=s(c),g={css:n[1],media:n[2],sourceMap:n[3]};-1!==u?(o[u].references++,o[u].updater(g)):o.push({identifier:c,updater:b(g,t),references:1}),a.push(c)}return a}function d(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var r=i.nc;r&&(a.nonce=r)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=n(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function g(e,t,i,a){var r=i?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var n=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}function p(e,t,i){var a=i.css,r=i.media,n=i.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),n&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var m=null,f=0;function b(e,t){var i,a,r;if(t.singleton){var n=f++;i=m||(m=d(t)),a=g.bind(null,i,n,!1),r=g.bind(null,i,n,!0)}else i=d(t),a=p.bind(null,i,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var i=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<i.length;a++){var r=s(i[a]);o[r].references--}for(var n=l(e,t),d=0;d<i.length;d++){var c=s(i[d]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}i=n}}}},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",a=e[3];if(!a)return i;if(t&&"function"==typeof btoa){var r=(o=a,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),n=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[i].concat(n).concat([r]).join("\n")}var o,s,l;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,a){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(a)for(var n=0;n<this.length;n++){var o=this[n][0];null!=o&&(r[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);a&&r[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),t.push(l))}},t}},function(e,t,i){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,t,i){"use strict";var a=e("../lib/oop"),r=e("./text_highlight_rules").TextHighlightRules,n=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};a.inherits(n,r),t.JsonHighlightRules=n})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(e,t,i){"use strict";var a=e("../range").Range,r=function(){};(function(){this.checkOutdent=function(e,t){return!!/^\s+$/.test(e)&&/^\s*\}/.test(t)},this.autoOutdent=function(e,t){var i=e.getLine(t).match(/^(\s*\})/);if(!i)return 0;var r=i[1].length,n=e.findMatchingBracket({row:t,column:r});if(!n||n.row==t)return 0;var o=this.$getIndent(e.getLine(n.row));e.replace(new a(t,0,t,r-1),o)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(r.prototype),t.MatchingBraceOutdent=r})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(e,t,i){"use strict";var a=e("../../lib/oop"),r=e("../../range").Range,n=e("./fold_mode").FoldMode,o=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};a.inherits(o,n),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(e,t,i){var a=e.getLine(i);if(this.singleLineBlockCommentRe.test(a)&&!this.startRegionRe.test(a)&&!this.tripleStarBlockCommentRe.test(a))return"";var r=this._getFoldWidgetBase(e,t,i);return!r&&this.startRegionRe.test(a)?"start":r},this.getFoldWidgetRange=function(e,t,i,a){var r,n=e.getLine(i);if(this.startRegionRe.test(n))return this.getCommentRegionBlock(e,n,i);if(r=n.match(this.foldingStartMarker)){var o=r.index;if(r[1])return this.openingBracketBlock(e,r[1],i,o);var s=e.getCommentFoldRange(i,o+r[0].length,1);return s&&!s.isMultiLine()&&(a?s=this.getSectionRange(e,i):"all"!=t&&(s=null)),s}if("markbegin"!==t&&(r=n.match(this.foldingStopMarker))){o=r.index+r[0].length;return r[1]?this.closingBracketBlock(e,r[1],i,o):e.getCommentFoldRange(i,o,-1)}},this.getSectionRange=function(e,t){for(var i=e.getLine(t),a=i.search(/\S/),n=t,o=i.length,s=t+=1,l=e.getLength();++t<l;){var d=(i=e.getLine(t)).search(/\S/);if(-1!==d){if(a>d)break;var c=this.getFoldWidgetRange(e,"all",t);if(c){if(c.start.row<=n)break;if(c.isMultiLine())t=c.end.row;else if(a==d)break}s=t}}return new r(n,o,s,e.getLine(s).length)},this.getCommentRegionBlock=function(e,t,i){for(var a=t.search(/\s*$/),n=e.getLength(),o=i,s=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,l=1;++i<n;){t=e.getLine(i);var d=s.exec(t);if(d&&(d[1]?l--:l++,!l))break}if(i>o)return new r(o,a,i,t.length)}}.call(o.prototype)})),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(e,t,a){"use strict";var r=e("../lib/oop"),n=e("./text").Mode,o=e("./json_highlight_rules").JsonHighlightRules,s=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("./behaviour/cstyle").CstyleBehaviour,d=e("./folding/cstyle").FoldMode,c=e("../worker/worker_client").WorkerClient,u=function(){this.HighlightRules=o,this.$outdent=new s,this.$behaviour=new l,this.foldingRules=new d};r.inherits(u,n),function(){this.getNextLineIndent=function(e,t,i){var a=this.$getIndent(t);"start"==e&&(t.match(/^.*[\{\(\[]\s*$/)&&(a+=i));return a},this.checkOutdent=function(e,t,i){return this.$outdent.checkOutdent(t,i)},this.autoOutdent=function(e,t,i){this.$outdent.autoOutdent(t,i)},this.createWorker=function(e){var t=new c(["ace"],i(38),"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t},this.$id="ace/mode/json"}.call(u.prototype),t.Mode=u}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(2);t.default=function(e){a.useEffect(e,[])}},function(e,t,i){switch(window.__kbnThemeTag__){case"v7dark":return i(30);case"v7light":return i(32);case"v8dark":return i(34);case"v8light":return i(36)}},function(e,t,i){var a=i(25),r=i(31);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1};a(r,n);e.exports=r.locals||{}},function(e,t,i){(t=i(26)(!1)).push([e.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#1D1E24;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #343741}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#1D1E24;padding:8px;border-radius:4px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#25262E}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#98A2B3}.visEditorSidebar__controls{border-top:1px solid #343741;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #343741;border-radius:4px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),e.exports=t},function(e,t,i){var a=i(25),r=i(33);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1};a(r,n);e.exports=r.locals||{}},function(e,t,i){(t=i(26)(!1)).push([e.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#fff;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #D3DAE6}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#fff;padding:8px;border-radius:4px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#fafbfd}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#69707D}.visEditorSidebar__controls{border-top:1px solid #D3DAE6;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #D3DAE6;border-radius:4px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),e.exports=t},function(e,t,i){var a=i(25),r=i(35);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1};a(r,n);e.exports=r.locals||{}},function(e,t,i){(t=i(26)(!1)).push([e.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#1D1E24;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #343741}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#1D1E24;padding:8px;border-radius:6px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#25262E}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#98A2B3}.visEditorSidebar__controls{border-top:1px solid #343741;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #343741;border-radius:6px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),e.exports=t},function(e,t,i){var a=i(25),r=i(37);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var n={insert:"head",singleton:!1};a(r,n);e.exports=r.locals||{}},function(e,t,i){(t=i(26)(!1)).push([e.i,".visEditor--default{flex:1 1 auto;display:flex}.visEditor__collapsibleSidebar{flex-grow:1}.visEditor__collapsibleSidebar-isClosed{min-width:0;width:32px !important}.visEditor__collapsibleSidebar-isClosed .visEditorSidebar{display:none;padding-left:0}.visEditor__collapsibleSidebarButton{position:absolute;right:4px;top:8px}.visEditor__resizer-isHidden{display:none}.visEditor__visualization__wrapper-expanded{width:100% !important}.visEditor__visualization{display:flex;flex:1 1 auto;overflow:hidden}.visEditor__canvas{background-color:#fff;display:flex;flex-direction:row;overflow:auto;flex-shrink:1;flex-basis:100%}.visEditor__canvas.embedded{flex-shrink:1;flex-basis:100%}.visEditor__canvas .visChart{position:relative}@media only screen and (max-width: 574px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditor--default{flex-direction:column}.visEditor__collapsibleSidebar{width:100% !important;flex-grow:0}.visEditor__collapsibleSidebar-isClosed{height:40px !important}.visEditor__resizer{display:none}.visEditor__visualization__wrapper{width:100% !important;flex:1;display:flex;flex-direction:column}}.visEditorSidebar{height:100%;padding-left:8px}@media only screen and (max-width: 574px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 575px) and (max-width: 767px){.visEditorSidebar{padding-left:0}}@media only screen and (min-width: 768px) and (max-width: 991px){.visEditorSidebar{padding-left:0}}.visEditorSidebar__form{flex:1 1 auto;display:flex;flex-direction:column;max-width:100%}.visEditorSidebar__form>*{flex-shrink:0}.visEditorSidebar__config{padding:8px}.visEditorSidebar__config>*{flex-grow:0}@media only screen and (min-width: 992px) and (max-width: 1199px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}@media only screen and (min-width: 1200px){.visEditorSidebar__config{flex:1 1 1px;display:flex;flex-direction:column;scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow:auto}.visEditorSidebar__config>*{flex-shrink:0}.visEditorSidebar__config::-webkit-scrollbar{width:16px;height:16px}.visEditorSidebar__config::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.visEditorSidebar__config::-webkit-scrollbar-corner,.visEditorSidebar__config::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}}.visEditorSidebar__config-isHidden{display:none}.visEditorSidebar__titleContainer{padding:8px 32px 8px 8px}.visEditorSidebar__indexPatternPlaceholder{min-height:40px;border-bottom:1px solid #D3DAE6}.visEditorSidebar__nav,.visEditorSidebar__linkedSearch{flex-grow:0}.visEditorSidebar__section{background-color:#fff;padding:8px;border-radius:6px}.visEditorSidebar__section+.visEditorSidebar__section{margin-top:8px}.visEditorSidebar__collapsible{background-color:#fafbfd}.visEditorSidebar__collapsible--marginBottom{margin-bottom:12px}.visEditorSidebar__formRow{display:flex;align-items:center;margin-top:12px}.visEditorSidebar__formLabel{display:flex;align-items:center;flex:1 1 40%;padding-right:4px}.visEditorSidebar__formControl{display:flex;align-items:center;flex:1 1 60%}.visEditorSidebar__aggGroupAccordionButtonContent{font-size:14px}.visEditorSidebar__aggGroupAccordionButtonContent span{color:#69707D}.visEditorSidebar__controls{border-top:1px solid #D3DAE6;padding:8px;display:flex;justify-content:flex-end;align-items:center}.visEditorSidebar__controls .visEditorSidebar__autoApplyButton{margin-left:12px}.visEditorAgg__subAgg{border:2px solid #D3DAE6;border-radius:6px;background-color:transparent;padding:8px}.visEditorAgg__subAgg+.visEditorAggParam__string{margin-top:16px}.visEditorAggParam--half{margin:16px 0;display:inline-block;width:calc(50% - 4px)}.visEditorAggParam--half-size{margin-left:8px}\n",""]),e.exports=t},function(e,t){e.exports.id="ace/mode/json_worker",e.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(19),r=i(2),n=a.__importDefault(i(40));t.default=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=[]);var a=n.default(e,t),o=a[0],s=a[1],l=a[2];return r.useEffect(l,i),[o,s]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(2);t.default=function(e,t){void 0===t&&(t=0);var i=a.useRef(!1),r=a.useRef(),n=a.useRef(e),o=a.useCallback((function(){return i.current}),[]),s=a.useCallback((function(){i.current=!1,r.current&&clearTimeout(r.current),r.current=setTimeout((function(){i.current=!0,n.current()}),t)}),[t]),l=a.useCallback((function(){i.current=null,r.current&&clearTimeout(r.current)}),[]);return a.useEffect((function(){n.current=e}),[e]),a.useEffect((function(){return s(),l}),[t]),[o,l,s]}},function(e,t,i){e.exports=i(14)(114)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(19),r=i(2),n=a.__importDefault(i(28));t.default=function(e){var t=r.useRef(e);t.current=e,n.default((function(){return function(){return t.current()}}))}},function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return Pt}));i(29),i(27);var a=i(2),r=i.n(a),n=i(1),o=i(9),s=i(20),l=i(8),d=i.n(l),c=i(5),u=i(3),g=i(0);function p({setSelectedTab:e,optionTabs:t}){return Object(g.jsx)(n.EuiTabs,{className:"visEditorSidebar__nav",size:"s"},t.map((({name:t,title:i,isSelected:a=!1})=>Object(g.jsx)(n.EuiTab,{key:t,isSelected:a,"data-test-subj":`visEditorTab__${t}`,onClick:()=>e(t)},i))))}var m=i(4),f=i(39),b=i.n(f),h=i(18);let v;!function(e){e.ADD_NEW_AGG="ADD_NEW_AGG",e.DISCARD_CHANGES="DISCARD_CHANGES",e.CHANGE_AGG_TYPE="CHANGE_AGG_TYPE",e.SET_AGG_PARAM_VALUE="SET_AGG_PARAM_VALUE",e.SET_STATE_PARAM_VALUE="SET_STATE_PARAM_VALUE",e.TOGGLE_ENABLED_AGG="TOGGLE_ENABLED_AGG",e.REMOVE_AGG="REMOVE_AGG",e.REORDER_AGGS="REORDER_AGGS",e.UPDATE_STATE_PARAMS="UPDATE_STATE_PARAMS"}(v||(v={}));const x=(e,t)=>e.find((e=>e.name===t))||{},j=(e,t,i)=>{const a=x(i,e.schema);return t.reduce(((t,i)=>i.schema===e.schema?++t:t),0)>a.min},E=e=>e.reduce(((e,t)=>"metric"===t.schema&&t.enabled?++e:e),0),w=(e,t,i,a)=>{if(!x(a,e.schema).mustBeFirst)return!1;const r=Object(c.findIndex)(i,(t=>t.schema!==e.schema));return-1!==r&&t>r};function y(e){return{...e.clone()}}const _={validity:{},touched:!1,invalid:!1};const O=e=>({type:v.DISCARD_CHANGES,payload:e});function S(e,t){const{services:i}=Object(o.useKibana)(),[r,n]=Object(a.useReducer)((({aggs:{createAggConfigs:e}})=>(t,i)=>{switch(i.type){case v.ADD_NEW_AGG:{const{schema:a}=i.payload,r=!t.data.aggs.aggs.find((e=>e.schema===a.name))&&a.defaults?a.defaults.slice(0,a.max):{schema:a.name},n=t.data.aggs.createAggConfig(r,{addToAggConfigs:!1});n.brandNew=!0;const o=[...t.data.aggs.aggs,n];return{...t,data:{...t.data,aggs:e(t.data.indexPattern,o)}}}case v.DISCARD_CHANGES:return y(i.payload);case v.CHANGE_AGG_TYPE:{const{aggId:a,value:r}=i.payload,n=t.data.aggs.aggs.map((e=>e.id===a?(e.type=r,e.toJSON()):e));return{...t,data:{...t.data,aggs:e(t.data.indexPattern,n)}}}case v.SET_AGG_PARAM_VALUE:{const{aggId:a,paramName:r,value:n}=i.payload,o=t.data.aggs.aggs.map((e=>{if(e.id===a){const t=e.toJSON();return{...t,params:{...t.params,[r]:n}}}return e}));return{...t,data:{...t.data,aggs:e(t.data.indexPattern,o)}}}case v.SET_STATE_PARAM_VALUE:{const{paramName:e,value:a}=i.payload;return{...t,params:{...t.params,[e]:a}}}case v.REMOVE_AGG:{let a=!1;const r=t.data.aggs.aggs.filter((({id:e,schema:t})=>{if(e===i.payload.aggId){const e=i.payload.schemas.find((e=>e.name===t));return e&&e.group===h.AggGroupNames.Metrics&&(a=!0),!1}return!0}));if(a&&0===E(r)){const e=r.find((e=>"metric"===e.schema));e&&(e.enabled=!0)}return{...t,data:{...t.data,aggs:e(t.data.indexPattern,r)}}}case v.REORDER_AGGS:{const{sourceAgg:a,destinationAgg:r}=i.payload,n=t.data.aggs.aggs.indexOf(r),o=[...t.data.aggs.aggs];return o.splice(n,0,o.splice(t.data.aggs.aggs.indexOf(a),1)[0]),{...t,data:{...t.data,aggs:e(t.data.indexPattern,o)}}}case v.TOGGLE_ENABLED_AGG:{const{aggId:a,enabled:r}=i.payload,n=t.data.aggs.aggs.map((e=>e.id===a?{...e.toJSON(),enabled:r}:e));return{...t,data:{...t.data,aggs:e(t.data.indexPattern,n)}}}case v.UPDATE_STATE_PARAMS:{const{params:e}=i.payload;return{...t,params:Object(c.cloneDeep)(e)}}}})(i.data.search),e,y);return[r,Object(a.useCallback)((e=>{n(e),t.emit("dirtyStateChange",{isDirty:e.type!==v.DISCARD_CHANGES})}),[t])]}function k({applyChanges:e,isDirty:t,isInvalid:i,isTouched:r,dispatch:o,vis:s}){const{enableAutoApply:l}=s.type.editorConfig,[d,c]=Object(a.useState)(!1),p=Object(a.useCallback)((e=>c(e)),[]),f=Object(a.useCallback)((()=>o(O(s))),[o,s]);return b()((()=>{d&&t&&e()}),300,[t,d,e]),Object(g.jsx)("div",{className:"visEditorSidebar__controls"},!d&&Object(g.jsx)(n.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiButtonEmpty,{"data-test-subj":"visualizeEditorResetButton",disabled:!t,iconType:"cross",onClick:f,size:"s"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.sidebar.discardChangesButtonLabel",defaultMessage:"Discard"}))),Object(g.jsx)(n.EuiFlexItem,{grow:!1},i&&r?Object(g.jsx)(n.EuiToolTip,{content:u.i18n.translate("visDefaultEditor.sidebar.errorButtonTooltip",{defaultMessage:"Errors in the highlighted fields need to be resolved."})},Object(g.jsx)(n.EuiButton,{color:"danger",iconType:"alert",size:"s",disabled:!0},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.sidebar.updateChartButtonLabel",defaultMessage:"Update"}))):Object(g.jsx)(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiIconTip,{content:u.i18n.translate("visDefaultEditor.sidebar.updateInfoTooltip",{defaultMessage:"CTRL + Enter is a shortcut for Update."}),type:"keyboardShortcut",color:"subdued"})),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiButton,{"data-test-subj":"visualizeEditorRenderButton",disabled:!t,fill:!0,iconType:"play",onClick:e,size:"s"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.sidebar.updateChartButtonLabel",defaultMessage:"Update"})))))),l&&Object(g.jsx)(n.EuiToolTip,{title:d?u.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOnLabel",{defaultMessage:"Auto apply is on"}):u.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOffLabel",{defaultMessage:"Auto apply is off"}),content:u.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesTooltip",{defaultMessage:"Auto updates the visualization on every change."})},Object(g.jsx)(n.EuiButton,{className:"visEditorSidebar__autoApplyButton","data-test-subj":"visualizeEditorAutoButton",iconType:"refresh",color:d?"primary":"text",fill:!0,onClick:()=>p(!d),size:"s",minWidth:80,"aria-label":d?u.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesLabelOn",{defaultMessage:"Auto apply is on"}):u.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesLabelOff",{defaultMessage:"Auto apply is off"})},d?u.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOn",{defaultMessage:"On"}):u.i18n.translate("visDefaultEditor.sidebar.autoApplyChangesOff",{defaultMessage:"Off"}))))}var A=i(21);function T({savedSearch:e,eventEmitter:t}){const[i,r]=Object(a.useState)(!1),{services:{application:s}}=Object(o.useKibana)(),l=Object(a.useCallback)((()=>r(!1)),[]),d=Object(a.useCallback)((()=>r((e=>!e))),[]),c=Object(a.useCallback)((()=>{r(!1),t.emit("unlinkFromSavedSearch")}),[t]),p=Object(a.useCallback)((()=>{s.navigateToApp("discover",{path:Object(A.getSavedSearchUrl)(e.id)})}),[s,e.id]),f=u.i18n.translate("visDefaultEditor.sidebar.savedSearch.linkButtonAriaLabel",{defaultMessage:"Link to saved search. Click to learn more or break link."});return Object(g.jsx)(n.EuiFlexGroup,{alignItems:"center",className:"visEditorSidebar__titleContainer visEditorSidebar__linkedSearch",gutterSize:"xs",responsive:!1},Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiIcon,{type:"search"})),Object(g.jsx)(n.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},Object(g.jsx)(n.EuiTitle,{size:"xs",className:"eui-textTruncate"},Object(g.jsx)("h2",{title:u.i18n.translate("visDefaultEditor.sidebar.savedSearch.titleAriaLabel",{defaultMessage:"Saved search: {title}",values:{title:e.title}})},e.title))),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiPopover,{anchorPosition:"downRight",button:Object(g.jsx)(n.EuiToolTip,{content:f},Object(g.jsx)(n.EuiButtonIcon,{"aria-label":f,"data-test-subj":"showUnlinkSavedSearchPopover",iconType:"link",onClick:d})),isOpen:i,closePopover:l,panelPaddingSize:"s"},Object(g.jsx)(n.EuiPopoverTitle,null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.popoverTitle",defaultMessage:"Linked to saved search"})),Object(g.jsx)("div",{style:{width:260}},Object(g.jsx)(n.EuiText,{size:"s"},Object(g.jsx)("p",null,Object(g.jsx)(n.EuiButtonEmpty,{"data-test-subj":"viewSavedSearch",flush:"left",onClick:p,size:"xs"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.goToDiscoverButtonText",defaultMessage:"View this search in Discover"}))),Object(g.jsx)("p",null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.popoverHelpText",defaultMessage:"Subsequent modifications to this saved search are reflected in the visualization. To disable automatic updates, remove the link."})),Object(g.jsx)("p",null,Object(g.jsx)(n.EuiButton,{color:"danger","data-test-subj":"unlinkSavedSearch",fullWidth:!0,onClick:c,size:"s"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.sidebar.savedSearch.unlinkSavedSearchButtonText",defaultMessage:"Remove link to saved search"}))))))))}function C({savedSearch:e,vis:t,isLinkedSearch:i,eventEmitter:a}){return i&&e?Object(g.jsx)(T,{savedSearch:e,eventEmitter:a}):t.type.options.showIndexSelection?Object(g.jsx)(n.EuiTitle,{size:"xs",className:"visEditorSidebar__titleContainer eui-textTruncate"},Object(g.jsx)("h2",{title:u.i18n.translate("visDefaultEditor.sidebar.indexPatternAriaLabel",{defaultMessage:"Index pattern: {title}",values:{title:t.data.indexPattern.title}})},t.data.indexPattern.title)):Object(g.jsx)("div",{className:"visEditorSidebar__indexPatternPlaceholder"})}var M=i(42),R=i.n(M);let I,L;function P(e,t){switch(t.type){case I.TOUCHED:return{...e,touched:t.payload};case I.VALID:return{...e,valid:t.payload};default:throw new Error}}function D(e,{type:t,paramName:i="",payload:a}){const r=e[i]||{valid:!0,touched:!1};switch(t){case L.TOUCHED:return{...e,[i]:{...r,touched:a}};case L.VALID:return{...e,[i]:{...r,valid:a}};case L.RESET:return{};default:throw new Error}}function F(e){return e.reduce(((e,t)=>(e[t.aggParam.name]={valid:!0,touched:!1},e)),{})}function B({aggError:e,id:t,indexPattern:i,value:r,setValue:s,aggTypeOptions:l,showValidation:d,isSubAggregation:p,onChangeAggType:f}){const[b,h]=Object(a.useState)(!1),{services:v}=Object(o.useKibana)(),x=r?[{label:r.title,target:r}]:[],j=p?Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.aggSelect.subAggregationLabel",defaultMessage:"Sub aggregation"}):Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.aggSelect.aggregationLabel",defaultMessage:"Aggregation"});let E;Object(c.has)(r,"name")&&(E=v.docLinks.links.aggs[r.name]);const w=r&&E&&Object(g.jsx)(n.EuiText,{size:"xs"},Object(g.jsx)(n.EuiLink,{href:E,target:"_blank",rel:"noopener"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.aggSelect.helpLinkLabel",defaultMessage:"{aggTitle} help",values:{aggTitle:r?r.title:""}}))),y=e?[e]:[];l.length||y.push(u.i18n.translate("visDefaultEditor.aggSelect.noCompatibleAggsDescription",{defaultMessage:"The index pattern {indexPatternTitle} does not have any aggregatable fields.",values:{indexPatternTitle:i&&i.title}}));const _=!!r&&!y.length&&!b,O=Object(a.useCallback)((e=>{const t=Object(c.get)(e,"0.target");t&&s(t)}),[s]),S=Object(a.useCallback)((e=>h(Boolean(e))),[]),k=Object(a.useCallback)((()=>f({type:I.TOUCHED,payload:!0})),[f]),A=Object(a.useCallback)((e=>f({type:I.VALID,payload:e})),[f]);return Object(a.useEffect)((()=>{A(_)}),[_,A]),Object(a.useEffect)((()=>{y.length&&k()}),[y.length,k]),Object(g.jsx)(n.EuiFormRow,{label:j,labelAppend:w,error:y,isInvalid:!!d&&!_,fullWidth:!0,display:"rowCompressed"},Object(g.jsx)(n.EuiComboBox,{placeholder:u.i18n.translate("visDefaultEditor.aggSelect.selectAggPlaceholder",{defaultMessage:"Select an aggregation"}),id:`visDefaultEditorAggSelect${t}`,isDisabled:!l.length,options:l,selectedOptions:x,singleSelection:{asPlainText:!0},onBlur:k,onChange:O,onSearchChange:S,"data-test-subj":"defaultEditorAggSelect",isClearable:!1,isInvalid:!!d&&!_,fullWidth:!0,sortMatchesBy:"startsWith",compressed:!0}))}function N(e){const{agg:t,aggParam:i,paramEditor:r,setAggParamValue:n,onChangeParamsState:o,...s}=e,l=Object(a.useCallback)((e=>{o({type:L.VALID,paramName:i.name,payload:e})}),[o,i.name]),c=Object(a.useCallback)(((e=!0)=>{o({type:L.TOUCHED,paramName:i.name,payload:e})}),[o,i.name]),u=Object(a.useCallback)((a=>{e.value!==a&&n(t.id,i.name,a)}),[n,t.id,i.name,e.value]);return Object(a.useEffect)((()=>{i.shouldShow&&!i.shouldShow(t)&&l(!0)}),[t,t.params.field,i,l]),i.shouldShow&&!i.shouldShow(t)?null:Object(g.jsx)(r,d()({agg:t,aggParam:i,setValidity:l,setTouched:c,setValue:u},s))}!function(e){e.TOUCHED="aggTypeTouched",e.VALID="aggTypeValid"}(I||(I={})),function(e){e.TOUCHED="aggParamsTouched",e.VALID="aggParamsValid",e.RESET="aggParamsReset"}(L||(L={}));const{propFilter:V}=h.search.aggs,z=V("name"),G=[(e,t,i,a)=>0!==z([e],a).length,(e,t,i,a)=>{const r=t.getAggregationRestrictions();if(!r)return!0;const n=e.name;return"count"===n||!!r&&Object.keys(r).includes(n)||!1}];const $=[(e,t)=>{const i=t.getIndexPattern().getAggregationRestrictions();if(!i)return!0;const a=i[t.type&&t.type.name];return!!a&&!!a[e.name]}];var q=i(12);var H=i(41),W=i.n(H),U=i(24),K=i.n(U);const J=Object(n.htmlIdGenerator)(),Y=(e="")=>{if(!e)return!0;const t=W.a.parse(e);return t&&t.isValid()};function X({value:e=!1,setValue:t,dataTestSubj:i,displayToolTip:a,displayLabel:r,disabled:o}){return Object(g.jsx)(n.EuiFormRow,{fullWidth:!0},Object(g.jsx)(n.EuiToolTip,{content:a,delay:"long",position:"right"},Object(g.jsx)(n.EuiSwitch,{compressed:!0,label:r,checked:e,disabled:o,"data-test-subj":i,onChange:e=>t(e.target.checked)})))}var Q=i(10);const Z=u.i18n.translate("visDefaultEditor.controls.field.fieldLabel",{defaultMessage:"Field"});function ee({agg:e,aggParam:t,customError:i,customLabel:r,indexedFields:o=[],showValidation:s,value:l,setTouched:d,setValidity:p,setValue:m}){const[f,b]=Object(a.useState)(!1),v=l?[{label:l.displayName,target:l,key:l.name}]:[],x=i?[i]:[];let j=!1;o.length||x.push(u.i18n.translate("visDefaultEditor.controls.field.noCompatibleFieldsDescription",{defaultMessage:"The index pattern {indexPatternTitle} does not contain any of the following compatible field types: {fieldTypes}",values:{indexPatternTitle:e.getIndexPattern&&e.getIndexPattern().title,fieldTypes:te(e)}})),l&&l.type===h.KBN_FIELD_TYPES.MISSING?(x.push(u.i18n.translate("visDefaultEditor.controls.field.fieldIsNotExists",{defaultMessage:'The field "{fieldParameter}" associated with this object no longer exists in the index pattern. Please use another field.',values:{fieldParameter:l.name}})),j=!0):l&&!ie(e).find((e=>e===l.type||"*"===e))&&(x.push(u.i18n.translate("visDefaultEditor.controls.field.invalidFieldForAggregation",{defaultMessage:'Saved field "{fieldParameter}" of index pattern "{indexPatternTitle}" is invalid for use with this aggregation. Please select a new field.',values:{fieldParameter:null==l?void 0:l.name,indexPatternTitle:e.getIndexPattern&&e.getIndexPattern().title}})),j=!0);const E=!!l&&!x.length&&!f,w=(s||!o.length||j)&&!E;Object(Q.g)(p,E),K()((()=>{if(1!==o.length)return;const e=o[0];"options"in e?1===e.options.length&&m(e.options[0].target):m(e.target)}));const y=Object(a.useCallback)((e=>b(Boolean(e))),[]);return Object(g.jsx)(n.EuiFormRow,{label:r||Z,isInvalid:w,fullWidth:!0,error:x,display:"rowCompressed"},Object(g.jsx)(n.EuiComboBox,{compressed:!0,placeholder:u.i18n.translate("visDefaultEditor.controls.field.selectFieldPlaceholder",{defaultMessage:"Select a field"}),options:o,isDisabled:!o.length,selectedOptions:v,singleSelection:{asPlainText:!0},isClearable:!1,isInvalid:w,onChange:i=>{const a=Object(c.get)(i,"0.target");t.required&&!a||m(a),t.onChange&&t.onChange(e)},onBlur:d,onSearchChange:y,sortMatchesBy:"startsWith","data-test-subj":"visDefaultEditorField",fullWidth:!0}))}function te(e){return Object(Q.a)(ie(e),{inclusive:!1})}function ie(e){const t=Object(c.get)(e,"type.params",[]).find((e=>"field"===e.name))||{};return Object(Q.c)(t.filterFieldTypes||[])}function ae({id:e,arrayIndex:t,customLabel:i,value:r,autoFocus:s,disableRemove:l,dataTestSubj:d,agg:c,onChangeValue:p,onRemoveFilter:m}){const{services:f}=Object(o.useKibana)(),[b,v]=Object(a.useState)(!1),x=u.i18n.translate("visDefaultEditor.controls.filters.filterLabel",{defaultMessage:"Filter {index}",values:{index:t+1}}),j=Object(g.jsx)("div",null,Object(g.jsx)(n.EuiButtonIcon,{iconType:"tag","aria-label":u.i18n.translate("visDefaultEditor.controls.filters.toggleFilterButtonAriaLabel",{defaultMessage:"Toggle filter label"}),"aria-expanded":b,"aria-controls":`visEditorFilterLabel${t}`,onClick:()=>v(!b)}),Object(g.jsx)(n.EuiButtonIcon,{iconType:"trash",color:"danger",disabled:l,"aria-label":u.i18n.translate("visDefaultEditor.controls.filters.removeFilterButtonAriaLabel",{defaultMessage:"Remove this filter"}),onClick:()=>m(e)}));return Object(g.jsx)(n.EuiForm,null,Object(g.jsx)(n.EuiFormRow,{label:`${x}${i?` - ${i}`:""}`,labelAppend:j,fullWidth:!0},Object(g.jsx)(h.QueryStringInput,{query:r,indexPatterns:[c.getIndexPattern()],onChange:t=>p(e,t,i),onBlur:()=>{r.query.length>0&&f.data.query.addToQueryLog(f.appName,r)},disableAutoFocus:!s,dataTestSubj:d,bubbleSubmitEvent:!0,languageSwitcherPopoverAnchorPosition:"leftDown",size:"s"})),b?Object(g.jsx)(n.EuiFormRow,{id:`visEditorFilterLabel${t}`,label:u.i18n.translate("visDefaultEditor.controls.filters.definiteFilterLabel",{defaultMessage:"Filter {index} label",description:"'Filter {index}' represents the name of the filter as a noun, similar to 'label for filter 1'.",values:{index:t+1}}),fullWidth:!0,display:"rowCompressed"},Object(g.jsx)(n.EuiFieldText,{value:i,placeholder:u.i18n.translate("visDefaultEditor.controls.filters.labelPlaceholder",{defaultMessage:"Label"}),onChange:t=>p(e,r,t.target.value),fullWidth:!0,compressed:!0})):null,Object(g.jsx)(n.EuiSpacer,{size:"m"}))}const re=Object(n.htmlIdGenerator)();const{isType:ne}=h.search.aggs;function oe({agg:e,aggParam:t,showValidation:i,value:r,setValidity:o,setValue:s,setTouched:l}){const d=!t.required||!!r;Object(a.useEffect)((()=>{o(d)}),[d,o]);const c=Object(a.useCallback)((e=>s(e.target.value)),[s]);return Object(g.jsx)(n.EuiFormRow,{className:"visEditorAggParam__string",label:t.displayName||t.name,fullWidth:!0,display:"rowCompressed",isInvalid:!!i&&!d},Object(g.jsx)(n.EuiFieldText,{value:r||"","data-test-subj":`visEditorStringInput${e.id}${t.name}`,onChange:c,fullWidth:!0,compressed:!0,onBlur:l,isInvalid:!!i&&!d}))}const se="(\\-?(?:\\d+(?:\\.\\d+)?|Infinity))",le=new RegExp("^\\s*([\\[|\\(])\\s*"+se+"\\s*,\\s*"+se+"\\s*([\\]|\\)])\\s*$");class NumberListRange{constructor(e,t,i,a){this.minInclusive=e,this.min=t,this.max=i,this.maxInclusive=a}within(e){return!(this.min===e&&!this.minInclusive||this.min>e)&&!(this.max===e&&!this.maxInclusive||this.max<e)}}function de(e){const t=String(e).match(le);if(!t)throw new TypeError("expected input to be in interval notation e.g., (100, 200]");const i=["["===t[1],parseFloat(t[2]),parseFloat(t[3]),"]"===t[4]];i[1]>i[2]&&i.reverse();const[a,r,n,o]=i;return new NumberListRange(a,r,n,o)}const ce="",ue=de("[0,Infinity)"),ge=Object(n.htmlIdGenerator)(),pe={value:0,id:ge(),isInvalid:!1};function me(e){const t=parseFloat(e);return isNaN(t)?ce:t}function fe(e){try{return e?de(e):ue}catch(e){throw new TypeError("Unable to parse range: "+e.message)}}function be(e,t){const i=Object(c.last)(e).value;let a=Number(i)?Number(i)+1:1;return a>=t.max&&(a=t.max-1),{id:ge(),value:a,isInvalid:!1}}function he(e){return e.length?e.map((e=>({value:void 0===e?ce:e,id:ge(),isInvalid:!1}))):[pe]}function ve(e,t,i,a=!1,r=!1){return e.length?e.map(((n,o)=>{const s=t[o]||{id:ge()},l=void 0===n?ce:n,d=i?function(e,t){const i={isInvalid:!1};return e===ce?(i.isInvalid=!0,i.error=ce):t.within(e)||(i.isInvalid=!0,i.error=u.i18n.translate("visDefaultEditor.controls.numberList.invalidRangeErrorMessage",{defaultMessage:"The value should be in the range of {min} to {max}.",values:{min:t.min,max:t.max}})),i}(l,i):{isInvalid:!1},c=a?function(e,t,i){const a={isInvalidOrder:!1},r=i[t-1];return void 0!==r&&void 0!==e&&e<=r&&(a.isInvalidOrder=!0,a.error=u.i18n.translate("visDefaultEditor.controls.numberList.invalidAscOrderErrorMessage",{defaultMessage:"Value is not in ascending order."})),a}(l,o,e):{isInvalidOrder:!1},g=r?function(e,t,i){const a={isDuplicate:!1};return e!==ce&&i.indexOf(e)!==t&&(a.isDuplicate=!0,a.error=u.i18n.translate("visDefaultEditor.controls.numberList.duplicateValueErrorMessage",{defaultMessage:"Duplicate value."})),a}(l,o,e):{isDuplicate:!1},p=[d.error,c.error,g.error].filter(Boolean).join(" ");return{...s,value:l,isInvalid:d.isInvalid||c.isInvalidOrder||g.isDuplicate,error:p===ce?void 0:p}})):[pe]}function xe({autoFocus:e,disableDelete:t,model:i,isInvalid:r,labelledbyId:o,range:s,onBlur:l,onDelete:d,onChange:c}){const p=u.i18n.translate("visDefaultEditor.controls.numberList.removeUnitButtonAriaLabel",{defaultMessage:"Remove the rank value of {value}",values:{value:i.value}}),m=Object(a.useCallback)((e=>c({value:e.target.value,id:i.id})),[c,i.id]),f=Object(a.useCallback)((()=>d(i.id)),[d,i.id]);return Object(g.jsx)(n.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"s"},Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldNumber,{"aria-labelledby":o,autoFocus:e,compressed:!0,isInvalid:r,placeholder:u.i18n.translate("visDefaultEditor.controls.numberList.enterValuePlaceholder",{defaultMessage:"Enter a value"}),onChange:m,value:i.value,fullWidth:!0,min:s.min,max:s.max,onBlur:l})),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiButtonIcon,{"aria-label":p,title:p,color:"danger",iconType:"trash",onClick:f,disabled:t})))}const je=Object(n.htmlIdGenerator)();function Ee({agg:e,aggParam:t,value:i,setValue:o,setTouched:s}){const[l,d]=Object(a.useState)(he(i&&Object(c.isArray)(i)?i:[ce])),u=Object(a.useMemo)((()=>fe("[-Infinity,Infinity]")),[]);Object(a.useEffect)((()=>{!Object(c.isArray)(i)||i.length===l.length&&i.every(((e,t)=>e===l[t].value))||d(i.map((e=>({id:je(),value:e,isInvalid:!1}))))}),[l,i]);const p=Object(a.useCallback)((e=>{d(e),o(e.map((({value:e})=>e)))}),[o]),f=Object(a.useCallback)((e=>{p(l.map((t=>t.id===e.id?{id:e.id,value:me(e.value),isInvalid:!1}:t)))}),[l,p]),b=Object(a.useCallback)((()=>{const e=[...l,{id:je(),value:ce,isInvalid:!1}];p(e)}),[l,p]),h=Object(a.useCallback)((e=>p(l.filter((t=>t.id!==e)))),[l,p]);return Object(g.jsx)(n.EuiFormRow,{id:`${t.name}-${e.id}}`,label:t.displayName||t.name,fullWidth:!0,display:"rowCompressed"},Object(g.jsx)(r.a.Fragment,null,l.map(((i,r)=>Object(g.jsx)(a.Fragment,{key:i.id},Object(g.jsx)(xe,{isInvalid:i.isInvalid,disableDelete:1===l.length,model:i,labelledbyId:`${t.name}-${e.id}-legend`,range:u,onDelete:h,onChange:f,onBlur:s,autoFocus:1!==l.length&&r===l.length-1}),l.length-1!==r&&Object(g.jsx)(n.EuiSpacer,{size:"s"})))),Object(g.jsx)(n.EuiSpacer,{size:"s"}),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:b,size:"xs"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.includeExclude.addUnitButtonLabel",defaultMessage:"Add value"})))))}const{isNumberType:we}=h.search.aggs;function ye(e){const{agg:t,value:i,setValue:r}=e,n=we(t);return Object(a.useEffect)((()=>{if(n&&!Array.isArray(i)&&void 0!==i){const e=i.split("|").map((e=>parseFloat(e))).filter((e=>Number.isFinite(e)));r(e.length?e:[""])}else!n&&Array.isArray(i)&&void 0!==i&&r(i.filter((e=>""!==e)).join("|"))}),[n,r,i]),n?Object(g.jsx)(Ee,d()({},e,{value:i})):Object(g.jsx)(oe,d()({},e,{value:i}))}const _e=Object(n.htmlIdGenerator)();function Oe({config:e,list:t,onChange:i,setValidity:o}){const{defaultValue:s,getModelValue:l,modelNames:d,onChangeFn:u,validateClass:p}=e,[f,b]=Object(a.useState)((()=>t.map((e=>({id:_e(),...l(e)}))))),h=f.some(e.hasInvalidValuesFn),v=Object(a.useCallback)((e=>{b(e),i(e.map(u))}),[u,i]),x=Object(a.useCallback)(((e,t,i)=>{const{model:a,isInvalid:r}=((e,t)=>{const i={model:e||"",isInvalid:!1};if(!e)return i.isInvalid=!1,i;try{return i.model=new t(e).toString(),i.isInvalid=!1,i}catch(e){return i.isInvalid=!0,i}})(t,p);v(f.map(((n,o)=>o===e?{...n,[i]:{value:t,model:a,isInvalid:r}}:n)))}),[f,v,p]),j=Object(a.useCallback)((e=>v(f.filter((t=>t.id!==e)))),[f,v]),E=Object(a.useCallback)((()=>v([...f,{id:_e(),...l()}])),[l,f,v]);return Object(a.useEffect)((()=>{t.length||v([{id:_e(),...s}])}),[s,t.length,v]),Object(a.useEffect)((()=>{o(!h)}),[h,o]),Object(a.useEffect)((()=>{(t.length!==f.length||t.some(((e,t)=>{const i=Object(c.mapValues)(Object(c.pick)(f[t],d),"model");return!Object(c.isEqual)(e,Object(c.omitBy)(i,c.isEmpty))})))&&b(t.map((e=>({id:_e(),...l(e)}))))}),[l,t,d,f]),Object(g.jsx)(r.a.Fragment,null,f.map(((t,i)=>Object(g.jsx)(a.Fragment,{key:t.id},Object(g.jsx)(n.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},e.renderInputRow(t,i,x),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiButtonIcon,{"aria-label":e.getRemoveBtnAriaLabel(t),title:e.getRemoveBtnAriaLabel(t),disabled:1===f.length,color:"danger",iconType:"trash",onClick:()=>j(t.id)}))),Object(g.jsx)(n.EuiSpacer,{size:"xs"})))),Object(g.jsx)(n.EuiSpacer,{size:"s"}),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:E,size:"xs"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.ipRanges.addRangeButtonLabel",defaultMessage:"Add range"}))))}const Se={defaultValue:{from:{value:"0.0.0.0",model:"0.0.0.0",isInvalid:!1},to:{value:"255.255.255.255",model:"255.255.255.255",isInvalid:!1}},validateClass:h.search.aggs.IpAddress,getModelValue:(e={})=>({from:{value:e.from||"",model:e.from||"",isInvalid:!1},to:{value:e.to||"",model:e.to||"",isInvalid:!1}}),getRemoveBtnAriaLabel:e=>u.i18n.translate("visDefaultEditor.controls.ipRanges.removeRangeAriaLabel",{defaultMessage:"Remove the range of {from} to {to}",values:{from:e.from.value||"*",to:e.to.value||"*"}}),onChangeFn:({from:e,to:t})=>{const i={};return e.model&&(i.from=e.model),t.model&&(i.to=t.model),i},hasInvalidValuesFn:({from:e,to:t})=>e.isInvalid||t.isInvalid,modelNames:["from","to"]};function ke({showValidation:e,onBlur:t,...i}){const o=Object(a.useCallback)(((i,a,o)=>Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldText,{"aria-label":u.i18n.translate("visDefaultEditor.controls.ipRanges.ipRangeFromAriaLabel",{defaultMessage:"IP range from: {value}",values:{value:i.from.value||"*"}}),compressed:!0,isInvalid:!!e&&i.from.isInvalid,placeholder:"*",onChange:e=>{o(a,e.target.value,"from")},value:i.from.value,onBlur:t})),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiIcon,{type:"sortRight",color:"subdued"})),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldText,{"aria-label":u.i18n.translate("visDefaultEditor.controls.ipRanges.ipRangeToAriaLabel",{defaultMessage:"IP range to: {value}",values:{value:i.to.value||"*"}}),compressed:!0,isInvalid:!!e&&i.to.isInvalid,placeholder:"*",onChange:e=>{o(a,e.target.value,"to")},value:i.to.value,onBlur:t})))),[t,e]),s={...Se,renderInputRow:o};return Object(g.jsx)(Oe,d()({config:s},i))}const Ae={defaultValue:{mask:{model:"0.0.0.0/1",value:"0.0.0.0/1",isInvalid:!1}},validateClass:h.search.aggs.CidrMask,getModelValue:(e={})=>({mask:{model:e.mask||"",value:e.mask||"",isInvalid:!1}}),getRemoveBtnAriaLabel:e=>e.mask.value?u.i18n.translate("visDefaultEditor.controls.ipRanges.removeCidrMaskButtonAriaLabel",{defaultMessage:"Remove the CIDR mask value of {mask}",values:{mask:e.mask.value}}):u.i18n.translate("visDefaultEditor.controls.ipRanges.removeEmptyCidrMaskButtonAriaLabel",{defaultMessage:"Remove the CIDR mask default value"}),onChangeFn:({mask:e})=>e.model?{mask:e.model}:{},hasInvalidValuesFn:({mask:e})=>e.isInvalid,modelNames:"mask"};function Te({showValidation:e,onBlur:t,...i}){const r=Object(a.useCallback)((({mask:i},a,r)=>Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldText,{"aria-label":u.i18n.translate("visDefaultEditor.controls.ipRanges.cidrMaskAriaLabel",{defaultMessage:"CIDR mask: {mask}",values:{mask:i.value||"*"}}),compressed:!0,fullWidth:!0,isInvalid:!!e&&i.isInvalid,placeholder:"*",onChange:e=>{r(a,e.target.value,"mask")},value:i.value,onBlur:t}))),[t,e]),o={...Ae,renderInputRow:r};return Object(g.jsx)(Oe,d()({config:o},i))}var Ce;!function(e){e.MASK="mask",e.FROM_TO="fromTo"}(Ce||(Ce={}));const Me=["!top_hits","!percentiles","!percentile_ranks","!median","!std_dev"],Re="EMPTY_VALUE",Ie=[{text:"",value:Re,hidden:!0}];const Le=Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.numberInterval.minimumIntervalLabel",defaultMessage:"Minimum interval"})," ",Object(g.jsx)(n.EuiIconTip,{position:"right",content:Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.numberInterval.minimumIntervalTooltip",defaultMessage:"Interval will be automatically scaled in the event that the provided value creates more buckets than specified by Advanced Setting's {histogramMaxBars}",values:{histogramMaxBars:h.UI_SETTINGS.HISTOGRAM_MAX_BARS}}),type:"questionInCircle"})),Pe="auto",De=u.i18n.translate("visDefaultEditor.controls.numberInterval.selectIntervalPlaceholder",{defaultMessage:"Enter an interval"}),Fe=u.i18n.translate("visDefaultEditor.controls.numberInterval.autoInteralIsUsed",{defaultMessage:"Auto interval is used"}),Be=u.i18n.translate("visDefaultEditor.controls.useAutoInterval",{defaultMessage:"Use auto interval"});const{termsAggFilter:Ne}=h.search.aggs,Ve="_key",ze=[{text:u.i18n.translate("visDefaultEditor.controls.orderAgg.alphabeticalLabel",{defaultMessage:"Alphabetical"}),value:Ve}],Ge=Object(Q.b)(Ne);function $e({labelledbyId:e,numberArray:t,range:i,showValidation:o,unitName:s,validateAscendingOrder:l=!1,disallowDuplicates:d=!1,onChange:c,setTouched:u,setValidity:p}){const f=Object(a.useMemo)((()=>fe(i)),[i]),[b,h]=Object(a.useState)(he(t));Object(a.useEffect)((()=>{h((e=>ve(t,e,f,l,d)))}),[t,f,l,d]),Object(a.useEffect)((()=>{t.length||c([b[0].value])}),[b,t.length,c]);const v=!b.find((({isInvalid:e})=>e));Object(Q.g)(p,v);const x=Object(a.useCallback)((e=>{h(e),c(e.map((({value:e})=>e===ce?void 0:e)))}),[c]),j=Object(a.useCallback)((({id:e,value:t})=>{const i=me(t);x(b.map((t=>t.id===e?{id:e,value:i,isInvalid:!1}:t)))}),[b,x]),E=Object(a.useCallback)((()=>{const e=[...b,be(b,f)];x(e)}),[b,f,x]),w=Object(a.useCallback)((e=>{const t=b.filter((t=>t.id!==e));x(t)}),[b,x]);return Object(g.jsx)(r.a.Fragment,null,b.map(((t,i)=>Object(g.jsx)(a.Fragment,{key:t.id},Object(g.jsx)(xe,{isInvalid:!!o&&t.isInvalid,disableDelete:1===b.length,model:t,labelledbyId:e,range:f,onDelete:w,onChange:j,onBlur:u,autoFocus:1!==b.length&&i===b.length-1}),o&&t.isInvalid&&t.error&&Object(g.jsx)(n.EuiFormErrorText,null,t.error),b.length-1!==i&&Object(g.jsx)(n.EuiSpacer,{size:"s"})))),Object(g.jsx)(n.EuiSpacer,{size:"s"}),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:E,size:"xs"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.numberList.addUnitButtonLabel",defaultMessage:"Add {unitName}",values:{unitName:s}}))))}var qe=i(6);var He=i(22),We=i(23);function Ue({disabled:e,iconTip:t,value:i,setValue:o,showValidation:s,setValidity:l,setTouched:d}){const u=Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.sizeLabel",defaultMessage:"Size"}),t),p=e||Number(i)>0;return Object(a.useEffect)((()=>{l(p)}),[p,l]),Object(g.jsx)(n.EuiFormRow,{label:u,fullWidth:!0,isInvalid:!!s&&!p,display:"rowCompressed"},Object(g.jsx)(n.EuiFieldNumber,{value:Object(c.isUndefined)(i)?"":i,onChange:e=>o(""===e.target.value?"":parseFloat(e.target.value)),fullWidth:!0,compressed:!0,isInvalid:!!s&&!p,onBlur:d,min:1,disabled:e,"data-test-subj":"sizeParamEditor"}))}function Ke({agg:e,aggParam:t,formIsTouched:i,metricAggs:a,state:o,setValue:s,setValidity:l,setTouched:d,schemas:c}){const p=u.i18n.translate("visDefaultEditor.controls.metrics.metricTitle",{defaultMessage:"Metric"}),m=u.i18n.translate("visDefaultEditor.controls.metrics.bucketTitle",{defaultMessage:"Bucket"}),f=t.name,b="customMetric"===f,v=b?p:m,x=b?h.AggGroupNames.Metrics:h.AggGroupNames.Buckets;K()((()=>{e.params[f]?s(e.params[f]):s(t.makeAgg(e))}));const{onAggTypeChange:j,setAggParamValue:E}=Object(Q.f)(e,t,e.params[f],s);return e.params[f]?Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiSpacer,{size:"m"}),Object(g.jsx)(n.EuiFormLabel,null,v),Object(g.jsx)(n.EuiSpacer,{size:"s"}),Object(g.jsx)(ht,{agg:e.params[f],allowedAggs:t.allowedAggs,groupName:x,className:"visEditorAgg__subAgg",formIsTouched:i,indexPattern:e.getIndexPattern(),metricAggs:a,state:o,setAggParamValue:E,onAggTypeChange:j,setValidity:l,setTouched:d,schemas:c,hideCustomLabel:!b})):null}const{parseEsInterval:Je,InvalidEsCalendarIntervalError:Ye}=h.search.aggs;function Xe(e){if("0ms"===e)return{isValidCalendarValue:!0};try{return Je(e),{isValidCalendarValue:!0}}catch(e){return e instanceof Ye?{isValidCalendarValue:!1,error:e.message}:{isValidCalendarValue:!0}}}const Qe=u.i18n.translate("visDefaultEditor.controls.timeInterval.invalidFormatErrorMessage",{defaultMessage:"Invalid interval format."}),Ze="auto";const et=Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.createsTooManyBucketsTooltip",defaultMessage:"This interval creates too many buckets to show in the selected time range, so it has been scaled up."}),tt=Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.createsTooLargeBucketsTooltip",defaultMessage:"This interval creates buckets that are too large to show in the selected time range, so it has been scaled down."}),it=Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.selectOptionHelpText",defaultMessage:"Select an option or create a custom value. Examples: 30s, 20m, 24h, 2d, 1w, 1M"});function at(e){const{options:t=[]}=e.getAggParams().find((({name:e})=>"aggregate"===e));return t.filter((t=>t.isCompatible(e)))}function rt({aggParam:e,value:t,showValidation:i,setValue:r,setValidity:o,setTouched:s}){const l=u.i18n.translate("visDefaultEditor.controls.orderLabel",{defaultMessage:"Order"}),d=!!t;return Object(a.useEffect)((()=>{o(d)}),[d,o]),Object(g.jsx)(n.EuiFormRow,{label:l,fullWidth:!0,isInvalid:!!i&&!d,display:"rowCompressed"},Object(g.jsx)(n.EuiSelect,{options:e.options,value:t&&t.value,onChange:t=>r(e.options.find((e=>e.value===t.target.value))),fullWidth:!0,compressed:!0,isInvalid:!!i&&!d,onBlur:s}))}const nt=u.i18n.translate("visDefaultEditor.controls.maxBars.autoPlaceholder",{defaultMessage:"Auto"}),ot=Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.maxBars.maxBarsLabel",defaultMessage:"Max bars"})," ",Object(g.jsx)(n.EuiIconTip,{position:"right",content:Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.maxBars.maxBarsHelpText",defaultMessage:"Intervals will be selected automatically based on the available data. The maximum number of bars can never be greater than the Advanced Setting's {histogramMaxBars}",values:{histogramMaxBars:h.UI_SETTINGS.HISTOGRAM_MAX_BARS}}),type:"questionInCircle"}));const{siblingPipelineType:st,parentPipelineType:lt}=h.search.aggs,dt={[h.BUCKET_TYPES.DATE_HISTOGRAM]:{scaleMetricValues:function(e){return Object(g.jsx)(X,d()({dataTestSubj:"scaleMetricsSwitch",displayLabel:u.i18n.translate("visDefaultEditor.controls.scaleMetricsLabel",{defaultMessage:"Scale metric values (deprecated)"}),displayToolTip:u.i18n.translate("visDefaultEditor.controls.scaleMetricsTooltip",{defaultMessage:"If you select a manual minimum interval and a larger interval will be used, enabling this will cause count and sum metrics to be scaled to the manual selected interval."})},e))},interval:function({agg:e,aggParam:t,editorConfig:i,value:o,setValue:s,showValidation:l,setTouched:d,setValidity:p}){const f=Object(c.get)(i,"interval.timeBase"),b=f?[]:(t.options||[]).reduce(((t,i)=>(i.enabled&&!i.enabled(e)||t.push({label:i.display,key:i.val}),t)),[]);let v,x=[];o&&(v=Object(c.find)(b,{key:o}),x=v?[v]:o===Ze?[]:[{label:o,key:"custom"}]);const{isValid:j,error:E,interval:w}=function(e,t,i,a){var r,n;if(i)return{isValid:!0,interval:null===(n=e.buckets)||void 0===n?void 0:n.getInterval()};if(!t||t===Ze&&!i)return{isValid:!1};if(!a){const{isValidCalendarValue:e,error:i}=Xe(t);if(!e)return{isValid:!1,error:i}}const o=h.search.aggs.isValidInterval(t,a);if(!o)return{isValid:!1,error:Qe};const s=null===(r=e.buckets)||void 0===r?void 0:r.getInterval(),{isValidCalendarValue:l,error:d}=Xe(s.expression);return l?{isValid:o,interval:s}:{isValid:!1,error:d}}(e,o,v,f),y=w&&w.scaled?Object(g.jsx)("strong",{"data-test-subj":"currentlyScaledText",className:"eui-displayBlock"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.timeInterval.scaledHelpText",defaultMessage:"Currently scaled to {bucketDescription}",values:{bucketDescription:Object(c.get)(w,"description")||""}})," ",Object(g.jsx)(n.EuiIconTip,{position:"right",type:"questionInCircle",content:w.scale<=1?et:tt})):null,_=Object(g.jsx)(r.a.Fragment,null,y,Object(c.get)(i,"interval.help")||it);return Object(a.useEffect)((()=>{p(j)}),[j,p]),Object(g.jsx)(n.EuiFormRow,{display:"rowCompressed",error:E,fullWidth:!0,helpText:_,isInvalid:l&&!j,label:u.i18n.translate("visDefaultEditor.controls.timeInterval.minimumIntervalLabel",{defaultMessage:"Minimum interval"})},Object(g.jsx)(n.EuiComboBox,{compressed:!0,fullWidth:!0,"data-test-subj":"visEditorInterval",isInvalid:l&&!j,noSuggestions:!!f,onChange:e=>{const t=Object(c.get)(e,"0");s(t?t.key:"")},onCreateOption:e=>s(e.trim()),options:b,selectedOptions:x,singleSelection:{asPlainText:!0},placeholder:u.i18n.translate("visDefaultEditor.controls.timeInterval.selectIntervalPlaceholder",{defaultMessage:"Select an interval"}),onBlur:d}))},drop_partials:function(e){return Object(g.jsx)(X,d()({dataTestSubj:"dropPartialBucketsCheckbox",displayLabel:u.i18n.translate("visDefaultEditor.controls.dropPartialBucketsLabel",{defaultMessage:"Drop partial buckets"}),displayToolTip:u.i18n.translate("visDefaultEditor.controls.dropPartialBucketsTooltip",{defaultMessage:"Remove buckets that span time outside the time range so the histogram doesn't start and end with incomplete buckets."})},e))}},[h.BUCKET_TYPES.DATE_RANGE]:{ranges:function({value:e=[],setValue:t,setValidity:i}){const{services:s}=Object(o.useKibana)(),[l,d]=Object(a.useState)((()=>e.map((e=>({...e,id:J()}))))),p=e.some((({from:e,to:t})=>!e&&!t||!Y(e)||!Y(t))),f=Object(a.useCallback)((e=>{t(e.map((e=>Object(c.omit)(e,"id")))),d(e)}),[t]),b=Object(a.useCallback)((()=>f([...l,{id:J()}])),[l,f]);K()((()=>{e.length||b()})),Object(a.useEffect)((()=>{(e.length!==l.length||e.some(((e,t)=>!Object(c.isEqual)(e,Object(c.omit)(l[t],"id")))))&&d(e.map((e=>({...e,id:J()}))))}),[l,e]),Object(a.useEffect)((()=>{i(!p)}),[p,i]);const h=(e,t,i)=>f(l.map((a=>a.id===e?{...a,[t]:""===i?void 0:i}:a)));return Object(g.jsx)(n.EuiFormRow,{display:"rowCompressed",fullWidth:!0},Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiText,{size:"xs"},Object(g.jsx)(n.EuiLink,{href:s.docLinks.links.date.dateMath,target:"_blank"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.dateRanges.acceptedDateFormatsLinkText",defaultMessage:"Acceptable date formats"}))),Object(g.jsx)(n.EuiSpacer,{size:"s"}),l.map((({from:t,to:i,id:r},o)=>{const s=u.i18n.translate("visDefaultEditor.controls.dateRanges.removeRangeButtonAriaLabel",{defaultMessage:"Remove the range of {from} to {to}",values:{from:t||"−∞",to:i||"+∞"}}),d=!t&&!i;return Object(g.jsx)(a.Fragment,{key:r},Object(g.jsx)(n.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldText,{"aria-label":u.i18n.translate("visDefaultEditor.controls.dateRanges.fromColumnLabel",{defaultMessage:"From",description:"Beginning of a date range, e.g. *From* 2018-02-26 To 2018-02-28"}),compressed:!0,fullWidth:!0,isInvalid:d||!Y(t),placeholder:"−∞",value:t||"",onChange:e=>h(r,"from",e.target.value),"data-test-subj":`visEditorDateRange${o}__from`})),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiIcon,{type:"sortRight",color:"subdued"})),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldText,{"aria-label":u.i18n.translate("visDefaultEditor.controls.dateRanges.toColumnLabel",{defaultMessage:"To",description:"End of a date range, e.g. From 2018-02-26 *To* 2018-02-28"}),"data-test-subj":`visEditorDateRange${o}__to`,compressed:!0,fullWidth:!0,isInvalid:d||!Y(i),placeholder:"+∞",value:i||"",onChange:e=>h(r,"to",e.target.value)})),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiButtonIcon,{title:s,"aria-label":s,disabled:1===e.length,color:"danger",iconType:"trash",onClick:()=>(e=>f(l.filter((t=>t.id!==e))))(r)}))),Object(g.jsx)(n.EuiSpacer,{size:"xs"}))})),p&&Object(g.jsx)(n.EuiFormErrorText,null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.dateRanges.errorMessage",defaultMessage:"Each range should have at least one valid date."})),Object(g.jsx)(n.EuiSpacer,{size:"s"}),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiButtonEmpty,{iconType:"plusInCircleFilled",onClick:b,size:"xs","data-test-subj":"visEditorAddDateRange"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.dateRanges.addRangeButtonLabel",defaultMessage:"Add range"})))))}},[h.BUCKET_TYPES.FILTERS]:{filters:function({agg:e,value:t=[],setValue:i}){const[s,l]=Object(a.useState)((()=>t.map((e=>({...e,id:re()})))));K()((()=>{i(s.map((e=>Object(c.omit)({...e,input:e.input},"id"))))})),Object(a.useEffect)((()=>{(t.length!==s.length||t.some(((e,t)=>!Object(c.isEqual)(e,Object(c.omit)(s[t],"id")))))&&l(t.map((e=>({...e,id:re()}))))}),[s,t]);const d=e=>{i(e.map((e=>Object(c.omit)(e,"id")))),l(e)},{services:u}=Object(o.useKibana)(),p=e=>d(s.filter((t=>t.id!==e))),f=(e,t,i)=>d(s.map((a=>a.id===e?{...a,input:t,label:i}:a)));return Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiSpacer,{size:"m"}),s.map((({input:t,label:i,id:a},r)=>Object(g.jsx)(ae,{key:a,id:a,arrayIndex:r,customLabel:i,value:t,autoFocus:r===s.length-1,disableRemove:0===r&&1===s.length,dataTestSubj:`visEditorFilterInput_${e.id}_${r}`,agg:e,onChangeValue:f,onRemoveFilter:p}))),Object(g.jsx)(n.EuiButton,{iconType:"plusInCircle",fill:!0,fullWidth:!0,onClick:()=>d([...s,{input:u.data.query.queryString.getDefaultQuery(),label:"",id:re()}]),size:"s","data-test-subj":"visEditorAddFilterButton"},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.filters.addFilterButtonLabel",defaultMessage:"Add filter"})),Object(g.jsx)(n.EuiSpacer,{size:"m"}))}},[h.BUCKET_TYPES.GEOHASH_GRID]:{autoPrecision:function({value:e=!1,setValue:t}){const i=u.i18n.translate("visDefaultEditor.controls.changePrecisionLabel",{defaultMessage:"Change precision on map zoom"});return Object(g.jsx)(n.EuiFormRow,{display:"rowCompressed"},Object(g.jsx)(n.EuiSwitch,{compressed:!0,label:i,checked:e,onChange:e=>t(e.target.checked)}))},precision:function({agg:e,value:t,setValue:i}){const{services:a}=Object(o.useKibana)(),r=u.i18n.translate("visDefaultEditor.controls.precisionLabel",{defaultMessage:"Precision"});return e.params.autoPrecision?null:Object(g.jsx)(n.EuiFormRow,{label:r,display:"rowCompressed"},Object(g.jsx)(n.EuiRange,{min:1,max:a.uiSettings.get("visualization:tileMap:maxPrecision"),value:t||"",onChange:e=>i(Number(e.currentTarget.value)),"data-test-subj":`visEditorMapPrecision${e.id}`,showValue:!0,compressed:!0}))},useGeocentroid:function({value:e=!1,setValue:t}){const i=u.i18n.translate("visDefaultEditor.controls.placeMarkersOffGridLabel",{defaultMessage:"Place markers off grid (use geocentroid)"});return Object(g.jsx)(n.EuiFormRow,{display:"rowCompressed"},Object(g.jsx)(n.EuiSwitch,{compressed:!0,label:i,checked:e,onChange:e=>t(e.target.checked)}))},isFilteredByCollar:function(e){return Object(g.jsx)(X,d()({displayLabel:u.i18n.translate("visDefaultEditor.controls.onlyRequestDataAroundMapExtentLabel",{defaultMessage:"Only request data around map extent"}),displayToolTip:u.i18n.translate("visDefaultEditor.controls.onlyRequestDataAroundMapExtentTooltip",{defaultMessage:"Apply geo_bounding_box filter aggregation to narrow the subject area to the map view box with collar"}),dataTestSubj:"isFilteredByCollarCheckbox"},e))}},[h.BUCKET_TYPES.HISTOGRAM]:{interval:function({agg:e,editorConfig:t,showValidation:i,value:r,setTouched:o,setValidity:s,setValue:l}){const d=e.getField(),u=!d||"number"===d.type,p=u&&(e=>e===Pe)(r),m=Object(c.get)(t,"interval.base"),f=m||0,b=""!==r&&void 0!==r&&(p||Number(r)>=f);Object(a.useEffect)((()=>{s(b)}),[b,s]);const h=Object(a.useCallback)((({target:e})=>l(isNaN(e.valueAsNumber)?"":e.valueAsNumber)),[l]),v=Object(a.useCallback)((e=>{const t=e.target.checked;l(t?Pe:"")}),[l]);return Object(g.jsx)(n.EuiFormRow,{display:"rowCompressed",label:Le,fullWidth:!0,isInvalid:i&&!b,helpText:Object(c.get)(t,"interval.help")},Object(g.jsx)(n.EuiFlexGroup,{gutterSize:"s",responsive:!1,direction:"column"},Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiSwitch,{label:Be,onChange:v,checked:p,compressed:!0,disabled:!u,"data-test-subj":`visEditorIntervalSwitch${e.id}`})),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldNumber,{value:p?"":r,min:f,step:m||"any","data-test-subj":`visEditorInterval${e.id}`,isInvalid:i&&!b,onChange:h,onBlur:o,disabled:p,fullWidth:!0,compressed:!0,placeholder:p?Fe:De}))))},maxBars:function({disabled:e,iconTip:t,value:i,setValue:r,showValidation:s,setValidity:l,setTouched:d}){var c;const{services:u}=Object(o.useKibana)(),p=null===(c=u.uiSettings)||void 0===c?void 0:c.get(h.UI_SETTINGS.HISTOGRAM_MAX_BARS),m=e||void 0===i||""===i||Number(i)>0||i<p;Object(a.useEffect)((()=>{l(m)}),[m,l]);const f=Object(a.useCallback)((e=>r(""===e.target.value?"":parseFloat(e.target.value))),[r]);return Object(g.jsx)(n.EuiFormRow,{label:ot,fullWidth:!0,isInvalid:!!s&&!m,display:"rowCompressed"},Object(g.jsx)(n.EuiFieldNumber,{value:i||"",placeholder:nt,onChange:f,min:1,fullWidth:!0,compressed:!0,max:p,isInvalid:!!s&&!m,onBlur:d,disabled:e,"data-test-subj":"maxBarsParamEditor"}))},min_doc_count:function(e){return Object(g.jsx)(X,d()({displayLabel:u.i18n.translate("visDefaultEditor.controls.showEmptyBucketsLabel",{defaultMessage:"Show empty buckets"}),displayToolTip:u.i18n.translate("visDefaultEditor.controls.showEmptyBucketsTooltip",{defaultMessage:"Show all buckets, not only the buckets with results"})},e))},has_extended_bounds:function(e){const{agg:t,setValue:i,value:r}=e,n=Object(a.useRef)(t.params.min_doc_count);return Object(a.useEffect)((()=>{n.current!==t.params.min_doc_count&&(n.current=t.params.min_doc_count,i(r&&t.params.min_doc_count))}),[t.params.min_doc_count,i,r]),Object(g.jsx)(X,d()({},e,{displayLabel:u.i18n.translate("visDefaultEditor.controls.extendedBoundsLabel",{defaultMessage:"Extend bounds"}),displayToolTip:u.i18n.translate("visDefaultEditor.controls.extendedBoundsTooltip",{defaultMessage:"Min and Max do not filter the results, but rather extend the bounds of the result set."}),disabled:!e.agg.params.min_doc_count||!(ne("number")(e.agg)||ne("date")(e.agg))}))},extended_bounds:function({value:e={},setValue:t,setValidity:i,showValidation:a,setTouched:r}){const o=u.i18n.translate("visDefaultEditor.controls.extendedBounds.minLabel",{defaultMessage:"Min"}),s=u.i18n.translate("visDefaultEditor.controls.extendedBounds.maxLabel",{defaultMessage:"Max"}),l=function({min:e,max:t}){return""!==e&&""!==t&&t>=e}(e);let d;l||(d=u.i18n.translate("visDefaultEditor.controls.extendedBounds.errorMessage",{defaultMessage:"Min should be less than or equal to Max."})),Object(Q.g)(i,l);const p=(i,a)=>{t({...e,[a]:""===i.target.value?"":parseFloat(i.target.value)})};return Object(g.jsx)(n.EuiFormRow,{fullWidth:!0,isInvalid:!!a&&!l,error:d},Object(g.jsx)(n.EuiFlexGroup,{gutterSize:"s",responsive:!1},Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldNumber,{value:Object(c.isUndefined)(e.min)?"":e.min,onChange:e=>p(e,"min"),onBlur:r,fullWidth:!0,isInvalid:!!a&&!l,"aria-label":o,prepend:o,compressed:!0})),Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)(n.EuiFieldNumber,{value:Object(c.isUndefined)(e.max)?"":e.max,onChange:e=>p(e,"max"),onBlur:r,fullWidth:!0,isInvalid:!!a&&!l,"aria-label":s,prepend:s,compressed:!0}))))}},[h.BUCKET_TYPES.IP_RANGE]:{ipRangeType:function({agg:e,value:t,setValue:i}){const a=[{id:`visEditorIpRangeFromToLabel${e.id}`,label:u.i18n.translate("visDefaultEditor.controls.ipRanges.fromToButtonLabel",{defaultMessage:"From/to"})},{id:`visEditorIpRangeCidrLabel${e.id}`,label:u.i18n.translate("visDefaultEditor.controls.ipRanges.cidrMasksButtonLabel",{defaultMessage:"CIDR masks"})}];return Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiSpacer,{size:"m"}),Object(g.jsx)(n.EuiButtonGroup,{isFullWidth:!0,onChange:e=>{i(e===a[0].id?Ce.FROM_TO:Ce.MASK)},idSelected:t===Ce.FROM_TO?a[0].id:a[1].id,options:a,legend:u.i18n.translate("visDefaultEditor.controls.ipRangesAriaLabel",{defaultMessage:"IP ranges"})}),Object(g.jsx)(n.EuiSpacer,{size:"s"}))},ranges:function({agg:e,value:t={fromTo:[],mask:[]},setTouched:i,setValue:r,setValidity:o,showValidation:s}){const l=Object(a.useCallback)((e=>r({...t,[Ce.MASK]:e})),[r,t]),d=Object(a.useCallback)((e=>r({...t,[Ce.FROM_TO]:e})),[r,t]);return Object(g.jsx)(n.EuiFormRow,{fullWidth:!0,id:`visEditorIpRange${e.id}`,display:"rowCompressed"},e.params.ipRangeType===Ce.MASK?Object(g.jsx)(Te,{list:t.mask,showValidation:s,onBlur:i,onChange:l,setValidity:o}):Object(g.jsx)(ke,{list:t.fromTo,showValidation:s,onBlur:i,onChange:d,setValidity:o}))}},[h.BUCKET_TYPES.RANGE]:{ranges:e=>Object(g.jsx)(qe.a,{value:e.value,setValue:e.setValue})},[h.BUCKET_TYPES.SIGNIFICANT_TERMS]:{size:Ue},[h.BUCKET_TYPES.TERMS]:{include:ye,exclude:ye,orderBy:function({agg:e,value:t,showValidation:i,setValue:a,setValidity:r,setTouched:o,metricAggs:s}){const l=u.i18n.translate("visDefaultEditor.controls.orderAgg.orderByLabel",{defaultMessage:"Order by"}),d=!!t;Object(Q.g)(r,d),K()((()=>{if(!t){let e={id:Ve};s&&(e=s.filter(Ge)[0]||e),a(e.id)}})),Object(Q.e)(a,Ne,s,t,Ve);const c=Object(Q.d)(Ne,s,ze);return Object(g.jsx)(n.EuiFormRow,{label:l,fullWidth:!0,isInvalid:i&&!d,display:"rowCompressed"},Object(g.jsx)(n.EuiSelect,{options:c,value:t,onChange:e=>a(e.target.value),fullWidth:!0,compressed:!0,isInvalid:i&&!d,onBlur:o,"data-test-subj":`visEditorOrderBy${e.id}`}))},orderAgg:function({agg:e,aggParam:t,formIsTouched:i,value:o,metricAggs:s,state:l,setValue:d,setValidity:c,setTouched:u,schemas:p}){const m=e.params.orderBy;Object(a.useEffect)((()=>{"custom"!==m||o||d(t.makeAgg(e)),"custom"!==m&&o&&d(void 0)}),[e,t,m,d,o]);const{onAggTypeChange:f,setAggParamValue:b}=Object(Q.f)(e,t,o,d);return e.params.orderAgg?Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiSpacer,{size:"m"}),Object(g.jsx)(ht,{agg:o,allowedAggs:t.allowedAggs,hideCustomLabel:!0,groupName:h.AggGroupNames.Metrics,className:"visEditorAgg__subAgg",formIsTouched:i,indexPattern:e.getIndexPattern(),metricAggs:s,state:l,setAggParamValue:b,onAggTypeChange:f,setValidity:c,setTouched:u,schemas:p})):null},order:Object(Q.h)(rt),size:Object(Q.h)(Ue),otherBucket:function(e){return Object(g.jsx)(X,d()({dataTestSubj:"otherBucketSwitch",displayLabel:u.i18n.translate("visDefaultEditor.controls.otherBucket.groupValuesLabel",{defaultMessage:"Group other values in separate bucket"}),displayToolTip:u.i18n.translate("visDefaultEditor.controls.otherBucket.groupValuesTooltip",{defaultMessage:"Values not in the top N are grouped in this bucket. To include documents with missing values, enable 'Show missing values'."})},e))},missingBucket:function(e){const t=!h.search.aggs.isStringType(e.agg),{setValue:i}=e;return Object(a.useEffect)((()=>{t&&i(!1)}),[t,i]),Object(g.jsx)(X,d()({},e,{dataTestSubj:"missingBucketSwitch",displayLabel:u.i18n.translate("visDefaultEditor.controls.otherBucket.showMissingValuesLabel",{defaultMessage:"Show missing values"}),displayToolTip:u.i18n.translate("visDefaultEditor.controls.otherBucket.showMissingValuesTooltip",{defaultMessage:'Only works for fields of type "string". When enabled, include documents with missing values in the search. If this bucket is in the top N, it appears in the chart. If not in the top N, and you enable "Group other values in separate bucket", Elasticsearch adds the missing values to the "other" bucket.'}),disabled:t}))}}},ct={[h.METRIC_TYPES.TOP_HITS]:{field:function(e){const t=at(e.agg);let i;return e.value&&!t.length&&(i=u.i18n.translate("visDefaultEditor.controls.aggregateWith.noAggsErrorTooltip",{defaultMessage:"The chosen field has no compatible aggregations."})),Object(g.jsx)(ee,d()({},e,{customError:i}))},aggregate:Object(Q.h)((function({agg:e,aggParam:t,value:i,showValidation:o,setValue:s,setValidity:l,setTouched:d}){const c=Object(a.useRef)(!0),p=e.params.field&&e.params.field.type,f={text:"",value:"EMPTY_VALUE",disabled:!0,hidden:!0},b=at(e).map((({text:e,value:t})=>({text:e,value:t}))).sort(((e,t)=>e.text.toLowerCase().localeCompare(t.text.toLowerCase()))),h=[f,...b],v=p&&!b.length,x=v||!!i,j=Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.aggregateWithLabel",defaultMessage:"Aggregate with"})," ",Object(g.jsx)(n.EuiIconTip,{position:"right",type:"questionInCircle",content:u.i18n.translate("visDefaultEditor.controls.aggregateWithTooltip",{defaultMessage:"Choose a strategy for combining multiple hits or a multi-valued field into a single metric."})}));return Object(a.useEffect)((()=>{l(x)}),[x,l]),Object(a.useEffect)((()=>{if(c.current)c.current=!1;else{if(i){if(t.options.find((e=>e.value===i.value)))return;s()}1===b.length&&s(t.options.find((e=>e.value===b[0].value)))}}),[t.options,p,b,s,i]),Object(g.jsx)(n.EuiFormRow,{label:j,fullWidth:!0,isInvalid:!!o&&!x,display:"rowCompressed"},Object(g.jsx)(n.EuiSelect,{options:h,value:i?i.value:f.value,onChange:e=>{e.target.value===f.value?s():s(t.options.find((t=>t.value===e.target.value)))},fullWidth:!0,compressed:!0,isInvalid:!!o&&!x,disabled:v,onBlur:d,"data-test-subj":"visDefaultEditorAggregateWith"}))})),size:Object(Q.h)((function(e){const t=Object(g.jsx)(r.a.Fragment,null," ",Object(g.jsx)(n.EuiIconTip,{position:"right",content:u.i18n.translate("visDefaultEditor.controls.sizeTooltip",{defaultMessage:"Request top-K hits. Multiple hits will be combined via 'aggregate with'."}),type:"questionInCircle"})),i=e.agg.params.field&&e.agg.params.field.type&&!at(e.agg).length;return Object(g.jsx)(Ue,d()({},e,{iconTip:t,disabled:i}))})),sortField:function(e){const t=u.i18n.translate("visDefaultEditor.controls.sortOnLabel",{defaultMessage:"Sort on"});return Object(g.jsx)(ee,d()({},e,{customLabel:t}))},sortOrder:rt},[h.METRIC_TYPES.PERCENTILES]:{percents:function({agg:e,showValidation:t,value:i=[],setTouched:r,setValidity:o,setValue:s}){const l=u.i18n.translate("visDefaultEditor.controls.percentiles.percentsLabel",{defaultMessage:"Percents"}),[d,c]=Object(a.useState)(!0),p=Object(a.useCallback)((e=>{c(e),o(e)}),[o]);return Object(g.jsx)(n.EuiFormRow,{label:l,labelType:"legend",fullWidth:!0,id:`visEditorPercentileLabel${e.id}`,isInvalid:!!t&&!d,display:"rowCompressed"},Object(g.jsx)($e,{labelledbyId:`visEditorPercentileLabel${e.id}-legend`,numberArray:i,range:"[0,100]",disallowDuplicates:!0,unitName:u.i18n.translate("visDefaultEditor.controls.percentileRanks.percentUnitNameText",{defaultMessage:"percent"}),showValidation:t,onChange:s,setTouched:r,setValidity:p}))}},[h.METRIC_TYPES.PERCENTILE_RANKS]:{values:function({agg:e,showValidation:t,value:i=[],setTouched:r,setValidity:o,setValue:s}){const l=u.i18n.translate("visDefaultEditor.controls.percentileRanks.valuesLabel",{defaultMessage:"Values"}),[d,c]=Object(a.useState)(!0),p=Object(a.useCallback)((e=>{c(e),o(e)}),[o]);return Object(g.jsx)(n.EuiFormRow,{label:l,labelType:"legend",fullWidth:!0,id:`visEditorPercentileRanksLabel${e.id}`,isInvalid:!!t&&!d,display:"rowCompressed","data-test-subj":"visEditorPercentileRanks"},Object(g.jsx)($e,{labelledbyId:`visEditorPercentileRanksLabel${e.id}-legend`,numberArray:i,range:"[-Infinity,Infinity]",unitName:u.i18n.translate("visDefaultEditor.controls.percentileRanks.valueUnitNameText",{defaultMessage:"value"}),validateAscendingOrder:!0,showValidation:t,onChange:s,setTouched:r,setValidity:p}))}}},ut={common:{string:oe,json:function({showValidation:e,value:t="",setValidity:i,setValue:s,setTouched:l}){const[d,c]=Object(a.useState)(!0),p=Object(a.useMemo)((()=>u.i18n.translate("visDefaultEditor.controls.jsonInputTooltip",{defaultMessage:"Any JSON formatted properties you add here will be merged with the elasticsearch aggregation definition for this section. For example 'shard_size' on a terms aggregation."})),[]),m=Object(a.useMemo)((()=>u.i18n.translate("visDefaultEditor.controls.jsonInputLabel",{defaultMessage:"JSON input"})),[]),f=Object(a.useMemo)((()=>Object(g.jsx)(r.a.Fragment,null,m," ",Object(g.jsx)(n.EuiIconTip,{position:"right",content:p,type:"questionInCircle"}))),[m,p]),b=Object(a.useCallback)((e=>{s(e);let t=!0;try{e&&JSON.parse(We.XJson.collapseLiteralStrings(e))}catch(e){t=!1}c(t),i(t)}),[i,c,s]);return Object(g.jsx)(n.EuiFormRow,{label:f,isInvalid:!!e&&!d,fullWidth:!0,display:"rowCompressed",onBlur:l},Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(o.CodeEditor,{"aria-label":m,"aria-describedby":"jsonEditorDescription",languageId:He.XJsonLang.ID,languageConfiguration:{autoClosingPairs:[{open:"{",close:"}"}]},width:"100%",height:"250px",value:t,onChange:b,options:{renderValidationDecorations:t?"on":"off",lineNumbers:"on",fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1,folding:!0,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0}}),Object(g.jsx)(n.EuiScreenReaderOnly,null,Object(g.jsx)("p",{id:"jsonEditorDescription"},p))))},field:ee},[st]:{customBucket:Ke,customMetric:Ke},[lt]:{metricAgg:function({agg:e,value:t,showValidation:i,setValue:r,setValidity:o,setTouched:s,metricAggs:l=[]}){const d=u.i18n.translate("visDefaultEditor.controls.metricLabel",{defaultMessage:"Metric"}),c=!!t;Object(Q.g)(o,c),Object(Q.e)(r,Me,l,t);const p=Object(a.useMemo)((()=>l.filter((t=>t.type.name!==e.type.name))),[l,e.type.name]),m=Object(Q.d)(Me,p,Ie),f=Object(a.useCallback)((e=>r(e.target.value)),[r]);return Object(g.jsx)(n.EuiFormRow,{label:d,fullWidth:!0,isInvalid:i&&!c,display:"rowCompressed"},Object(g.jsx)(n.EuiSelect,{compressed:!0,fullWidth:!0,options:m,value:t||Re,onChange:f,isInvalid:i&&!c,onBlur:s,"data-test-subj":`visEditorSubAggMetric${e.id}`}))},customMetric:function({agg:e,aggParam:t,formIsTouched:i,metricAggs:o,state:s,setValue:l,setValidity:d,setTouched:c,schemas:u}){Object(a.useEffect)((()=>{"custom"!==e.params.metricAgg?l(void 0):e.params.customMetric||l(t.makeAgg(e))}),[o,e,l,t]);const{onAggTypeChange:p,setAggParamValue:m}=Object(Q.f)(e,t,e.params.customMetric,l);return"custom"===e.params.metricAgg&&e.params.customMetric?Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiSpacer,{size:"m"}),Object(g.jsx)(ht,{agg:e.params.customMetric,allowedAggs:t.allowedAggs,groupName:h.AggGroupNames.Metrics,className:"visEditorAgg__subAgg",formIsTouched:i,indexPattern:e.getIndexPattern(),metricAggs:o,state:s,setAggParamValue:m,onAggTypeChange:p,setValidity:d,setTouched:c,schemas:u,hideCustomLabel:!0})):null}},[h.AggGroupNames.Buckets]:dt,[h.AggGroupNames.Metrics]:ct};function gt({agg:e,editorConfig:t,metricAggs:i,state:a,schemas:r,hideCustomLabel:n}){const o={basic:[],advanced:[]},s=e.type&&e.type.params.filter((e=>!Object(c.get)(t,[e.name,"hidden"],!1)))||[],l=x(r,e.schema);return s.forEach(((s,d)=>{let u,g=[];if(n&&"customLabel"===s.name)return;if("timeShift"===s.name)return;if("field"===s.type){let t=s.getAvailableFields(e);if("top_hits"===e.type.name&&"field"===s.name){Object(c.get)(l,`aggSettings[${e.type.name}].allowStrings`,!1)||(t=t.filter((e=>"number"===e.type)))}if(u=function(e,t){return e.filter((e=>$.every((i=>i(e,t)))))}(t,e),g=Object(q.a)(u,"type","displayName","name"),u&&!g.length&&d>0)return}const p=s.advanced?"advanced":"basic";let m;if(e.type.subtype&&ut[e.type.subtype])m=Object(c.get)(ut,[e.type.subtype,s.name]);else{const t=e.type.type,i=e.type.name,a=Object(c.get)(ut,[t,i],{});m=Object(c.get)(a,s.name)}m||(m=Object(c.get)(ut,["common",s.type])),m&&o[p].push({agg:e,aggParam:s,editorConfig:t,indexedFields:g,paramEditor:m,metricAggs:i,state:a,value:e.params[s.name],schemas:r,hideCustomLabel:n})})),o}function pt(e,t,i,a,r){const n=function(e,t,i,a){return e.filter((e=>G.every((r=>r(e,t,i,a)))))}(e[a],i,t,r);return Object(q.a)(n,"subtype","title")}function mt(e){let t="";if(e.type&&e.type.makeLabel)try{t=e.type.makeLabel(e)}catch(e){}return t}const ft="fixedValue",bt="default";function ht({agg:e,aggError:t,aggIndex:i=0,aggIsTooLow:s=!1,className:l,disabledParams:p,groupName:m,formIsTouched:f,indexPattern:b,metricAggs:v,state:j,setAggParamValue:E,onAggTypeChange:w,setTouched:y,setValidity:_,schemas:O,allowedAggs:S=[],hideCustomLabel:k=!1}){var A,T,C;const M=Object(a.useMemo)((()=>x(O,e.schema)),[e.schema,O]),I=Object(a.useMemo)((()=>[...S,...M.aggFilter||[]]),[S,M.aggFilter]),{services:V}=Object(o.useKibana)(),z=Object(a.useMemo)((()=>V.data.search.aggs.types.getAll()),[V.data.search.aggs.types]),G=Object(a.useMemo)((()=>pt(z,e,b,m,I)),[z,e,b,m,I]),$=s?u.i18n.translate("visDefaultEditor.aggParams.errors.aggWrongRunOrderErrorMessage",{defaultMessage:'"{schema}" aggs must run before all other buckets!',values:{schema:M.title}}):"",q=null===(A=e.type)||void 0===A?void 0:A.name,H=null===(T=e.params)||void 0===T||null===(C=T.field)||void 0===C?void 0:C.name,W=Object(a.useMemo)((()=>function(e,t,i){const a=e.getAggregationRestrictions();if(!a||!t||!i)return{};if("terms"===t)return{otherBucket:{hidden:!0},missingBucket:{hidden:!0}};const r=a[t]&&a[t][i];if(!r)return{};if("histogram"===t){const e=r.interval;return e?{intervalBase:{fixedValue:e},interval:{base:e,help:u.i18n.translate("visDefaultEditor.editorConfig.histogram.interval.helpText",{defaultMessage:"Must be a multiple of configuration interval: {interval}",values:{interval:e}})}}:{}}if("date_histogram"===t){const e=r.calendar_interval||r.fixed_interval;return{useNormalizedEsInterval:{fixedValue:!1},interval:{default:e,timeBase:e,help:u.i18n.translate("visDefaultEditor.editorConfig.dateHistogram.customInterval.helpText",{defaultMessage:"Must be a multiple of configuration interval: {interval}",values:{interval:e}})}}}return{}}(b,q,H)),[b,q,H]),U=Object(a.useMemo)((()=>gt({agg:e,editorConfig:W,metricAggs:v,state:j,schemas:O,hideCustomLabel:k})),[e,W,v,j,O,k]),K=[...U.basic,...U.advanced],[J,Y]=Object(a.useReducer)(D,K,F),[X,Q]=Object(a.useReducer)(P,{touched:!1,valid:!0}),Z=!$&&X.valid&&Object.entries(J).every((([,e])=>e.valid)),ee=!!$||function(e,t,i){if(!e)return t.touched;const a=Object.values(i).filter((e=>!e.valid));return!Object(c.isEmpty)(a)&&a.every((e=>e.touched))}(e.type,X,J),te=Object(a.useCallback)((t=>{e.type!==t&&(w(e.id,t),Y({type:L.RESET}))}),[w,e]);return R()((()=>_(!0))),Object(a.useEffect)((()=>{Object.entries(W).forEach((([t,i])=>{const a=e.type.params.find((e=>e.name===t)),r=i.hasOwnProperty(ft),n=i.hasOwnProperty(bt);if(r||n){let r,o=ft,s=i;n&&(o=bt,s=i),r=a&&a.deserialize?a.deserialize(s[o]):s[o],e.params[t]!==r&&E(e.id,t,r)}}))}),[W]),Object(a.useEffect)((()=>{y(!1)}),[e.type,y]),Object(a.useEffect)((()=>{_(Z)}),[Z,e.type,_]),Object(a.useEffect)((()=>{y(ee)}),[ee,y]),Object(g.jsx)(n.EuiForm,{className:l,isInvalid:!!$,error:$,"data-test-subj":"visAggEditorParams"},Object(g.jsx)(B,{aggError:t,id:e.id,indexPattern:b,value:e.type,aggTypeOptions:G,isSubAggregation:i>=1&&m===h.AggGroupNames.Buckets,showValidation:f||X.touched,setValue:te,onChangeAggType:Q}),U.basic.map((t=>{const i=J[t.aggParam.name]||{touched:!1,valid:!0};return Object(g.jsx)(N,d()({key:`${t.aggParam.name}${e.type?e.type.name:""}`,disabled:p&&p.includes(t.aggParam.name),formIsTouched:f,showValidation:f||i.touched,setAggParamValue:E,onChangeParamsState:Y},t))})),U.advanced.length?Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiSpacer,{size:"m"}),Object(g.jsx)(n.EuiAccordion,{id:"advancedAccordion","data-test-subj":`advancedParams-${e.id}`,buttonContent:u.i18n.translate("visDefaultEditor.advancedToggle.advancedLinkLabel",{defaultMessage:"Advanced"})},Object(g.jsx)(n.EuiSpacer,{size:"s"}),U.advanced.map((t=>{const i=J[t.aggParam.name]||{touched:!1,valid:!0};return Object(g.jsx)(N,d()({key:`${t.aggParam.name}${e.type?e.type.name:""}`,disabled:p&&p.includes(t.aggParam.name),formIsTouched:f,showValidation:f||i.touched,setAggParamValue:E,onChangeParamsState:Y},t))})))):null)}let vt;function xt(e,t){const i=e[t.aggId]||{touched:!1,valid:!0};switch(t.type){case vt.TOUCHED:return{...e,[t.aggId]:{...i,touched:t.payload}};case vt.VALID:return{...e,[t.aggId]:{...i,valid:t.payload}};default:throw new Error}}function jt(e){return e.reduce(((e,t)=>(e[t.id]={touched:!1,valid:!0},e)),{})}!function(e){e.TOUCHED="aggsTouched",e.VALID="aggsValid"}(vt||(vt={}));const Et="row",wt="visEditorSplitBy__true",yt="visEditorSplitBy__false";function _t({editorStateParams:e,setStateParamValue:t}){void 0===e.row&&t(Et,!0);const i=`visEditorSplitBy__${e.row}`,o=[{id:wt,label:u.i18n.translate("visDefaultEditor.controls.rowsLabel",{defaultMessage:"Rows"}),"data-test-subj":"visEditorSplitBy-Rows"},{id:yt,label:u.i18n.translate("visDefaultEditor.controls.columnsLabel",{defaultMessage:"Columns"}),"data-test-subj":"visEditorSplitBy-Columns"}],s=Object(a.useCallback)((e=>t(Et,e===wt)),[t]);return Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiFormRow,{display:"rowCompressed",fullWidth:!0},Object(g.jsx)(n.EuiButtonGroup,{"data-test-subj":"visEditorSplitBy",legend:u.i18n.translate("visDefaultEditor.controls.splitByLegend",{defaultMessage:"Split chart by rows or columns."}),options:o,isFullWidth:!0,idSelected:i,onChange:s})),Object(g.jsx)(n.EuiSpacer,{size:"m"}))}const Ot="radiusRatio";function St({editorStateParams:e,setStateParamValue:t}){const i=Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.controls.dotSizeRatioLabel",defaultMessage:"Dot size ratio"})," ",Object(g.jsx)(n.EuiIconTip,{content:u.i18n.translate("visDefaultEditor.controls.dotSizeRatioHelpText",{defaultMessage:"Change the ratio of the radius of the smallest point to the largest point."}),position:"right"}));K()((()=>{e.radiusRatio||t(Ot,50)}));const o=Object(a.useCallback)((e=>t(Ot,parseFloat(e.currentTarget.value))),[t]);return Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiFormRow,{fullWidth:!0,label:i,display:"rowCompressed"},Object(g.jsx)(n.EuiRange,{compressed:!0,fullWidth:!0,min:1,max:100,value:e.radiusRatio||50,onChange:o,showRange:!0,showValue:!0,valueAppend:"%"})),Object(g.jsx)(n.EuiSpacer,{size:"m"}))}function kt({agg:e,aggIndex:t,aggIsTooLow:i,dragHandleProps:o,formIsTouched:s,groupName:l,isDisabled:d,isDraggable:c,isLastBucket:p,isRemovable:m,metricAggs:f,lastParentPipelineAggTitle:b,state:h,setAggParamValue:v,setStateParamValue:j,onAggTypeChange:E,onToggleEnableAgg:w,removeAgg:y,setAggsState:_,schemas:O,timeRange:S}){var k;const[A,T]=Object(a.useState)(e.brandNew),[C,M]=Object(a.useState)(!0),R=!A&&C,I=!A&&!C,L=null===(k=e.type)||void 0===k?void 0:k.name,P=x(O,e.schema).title;let D,F;const B=p&&b&&e.type;let N;"split"===e.schema&&(N=_t),"radius"===e.schema&&(N=St),B&&(["date_histogram","histogram"].includes(L)?D=["min_doc_count"]:F=u.i18n.translate("visDefaultEditor.metrics.wrongLastBucketTypeErrorMessage",{defaultMessage:'Last bucket aggregation must be "Date Histogram" or "Histogram" when using "{type}" metric aggregation.',values:{type:b},description:"Date Histogram and Histogram should not be translated"}));const[V,z]=Object(a.useState)(mt(e));Object(a.useEffect)((()=>{S&&"date_histogram"===L&&e.aggConfigs.setTimeRange(S),z(mt(e))}),[e,L,S]),Object(a.useEffect)((()=>{B&&["date_histogram","histogram"].includes(L)&&v(e.id,"min_doc_count","histogram"===L||0)}),[L,B,e.id,v]);const G=Object(a.useCallback)((t=>{_({type:vt.TOUCHED,payload:t,aggId:e.id})}),[e.id,_]),$=Object(a.useCallback)((t=>{_({type:vt.VALID,payload:t,aggId:e.id}),M(t)}),[e.id,_]),q=Object(a.useCallback)((e=>{T(e),e||G(!0)}),[G]),H=Object(g.jsx)(r.a.Fragment,null,P||e.schema," ",R&&Object(g.jsx)("span",null,V));return Object(g.jsx)(n.EuiAccordion,{id:`visEditorAggAccordion${e.id}`,initialIsOpen:A,buttonContent:H,buttonClassName:"eui-textTruncate",buttonContentClassName:"visEditorSidebar__aggGroupAccordionButtonContent eui-textTruncate",className:"visEditorSidebar__section visEditorSidebar__collapsible visEditorSidebar__collapsible--marginBottom","aria-label":u.i18n.translate("visDefaultEditor.agg.toggleEditorButtonAriaLabel",{defaultMessage:"Toggle {schema} editor",values:{schema:P||e.schema}}),"data-test-subj":`visEditorAggAccordion${e.id}`,extraAction:(()=>{var t,i;const a=[],r=null===(t=e.type)||void 0===t||null===(i=t.title)||void 0===i?void 0:i.toLowerCase();return I&&a.push({id:"hasErrors",color:"danger",type:"alert",tooltip:u.i18n.translate("visDefaultEditor.agg.errorsAriaLabel",{defaultMessage:"{schemaTitle} {aggTitle} aggregation has errors",values:{aggTitle:r,schemaTitle:P}}),dataTestSubj:"hasErrorsAggregationIcon"}),e.enabled&&m&&a.push({id:"disableAggregation",color:"text",disabled:d,type:"eye",onClick:()=>w(e.id,!1),tooltip:u.i18n.translate("visDefaultEditor.agg.disableAggButtonTooltip",{defaultMessage:"Disable {schemaTitle} {aggTitle} aggregation",values:{aggTitle:r,schemaTitle:P}}),dataTestSubj:"toggleDisableAggregationBtn disable"}),e.enabled||a.push({id:"enableAggregation",color:"text",type:"eyeClosed",onClick:()=>w(e.id,!0),tooltip:u.i18n.translate("visDefaultEditor.agg.enableAggButtonTooltip",{defaultMessage:"Enable {schemaTitle} {aggTitle} aggregation",values:{aggTitle:r,schemaTitle:P}}),dataTestSubj:"toggleDisableAggregationBtn enable"}),c&&a.push({id:"dragHandle",type:"grab",tooltip:u.i18n.translate("visDefaultEditor.agg.modifyPriorityButtonTooltip",{defaultMessage:"Modify priority of {schemaTitle} {aggTitle} by dragging",values:{aggTitle:r,schemaTitle:P}}),dataTestSubj:"dragHandleBtn"}),m&&a.push({id:"removeDimension",color:"danger",type:"cross",onClick:()=>y(e.id),tooltip:u.i18n.translate("visDefaultEditor.agg.removeDimensionButtonTooltip",{defaultMessage:"Remove {schemaTitle} {aggTitle} aggregation",values:{aggTitle:r,schemaTitle:P}}),dataTestSubj:"removeDimensionBtn"}),Object(g.jsx)("div",o,a.map((e=>"dragHandle"===e.id?Object(g.jsx)(n.EuiIconTip,{key:e.id,type:e.type,content:e.tooltip,iconProps:{"aria-label":e.tooltip,"data-test-subj":e.dataTestSubj},position:"bottom"}):Object(g.jsx)(n.EuiToolTip,{key:e.id,position:"bottom",content:e.tooltip},Object(g.jsx)(n.EuiButtonIcon,{disabled:e.disabled,iconType:e.type,color:e.color,onClick:e.onClick,"aria-label":e.tooltip,"data-test-subj":e.dataTestSubj})))))})(),onToggle:q},Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiSpacer,{size:"m"}),N&&Object(g.jsx)(N,{agg:e,editorStateParams:h.params,setAggParamValue:v,setStateParamValue:j}),Object(g.jsx)(ht,{agg:e,aggError:F,aggIndex:t,aggIsTooLow:i,disabledParams:D,formIsTouched:s,groupName:l,indexPattern:e.getIndexPattern(),metricAggs:f,state:h,setAggParamValue:v,onAggTypeChange:E,setTouched:G,setValidity:$,schemas:O})))}function At({group:e=[],groupName:t,schemas:i,addSchema:r,stats:o}){const[s,l]=Object(a.useState)(!1),d=t===h.AggGroupNames.Buckets?u.i18n.translate("visDefaultEditor.aggAdd.bucketLabel",{defaultMessage:"bucket"}):u.i18n.translate("visDefaultEditor.aggAdd.metricLabel",{defaultMessage:"metric"}),c=Object(g.jsx)(n.EuiButtonEmpty,{size:"s",iconType:"plusInCircleFilled","data-test-subj":`visEditorAdd_${t}`,onClick:()=>l(!s),"aria-label":u.i18n.translate("visDefaultEditor.aggAdd.addGroupButtonLabel",{defaultMessage:"Add {groupNameLabel}",values:{groupNameLabel:d}})},Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.aggAdd.addButtonLabel",defaultMessage:"Add"})),p=(e,t)=>{var i;return null!==(i=e.disabled)&&void 0!==i?i:t},f=u.i18n.translate("visDefaultEditor.aggAdd.maxBuckets",{defaultMessage:"Max {groupNameLabel} count reached",values:{groupNameLabel:d}});return Object(g.jsx)(n.EuiFlexGroup,{justifyContent:"center",responsive:!1},Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(n.EuiPopover,{id:`addGroupButtonPopover_${t}`,button:c,isOpen:s,panelPaddingSize:"none",repositionOnScroll:!0,closePopover:()=>l(!1)},Object(g.jsx)(n.EuiPopoverTitle,{paddingSize:"s"},(t!==h.AggGroupNames.Buckets||!o.count)&&Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.aggAdd.addGroupButtonLabel",defaultMessage:"Add {groupNameLabel}",values:{groupNameLabel:d}}),t===h.AggGroupNames.Buckets&&o.count>0&&Object(g.jsx)(m.FormattedMessage,{id:"visDefaultEditor.aggAdd.addSubGroupButtonLabel",defaultMessage:"Add sub-{groupNameLabel}",values:{groupNameLabel:d}})),Object(g.jsx)(n.EuiContextMenuPanel,{items:i.map((i=>{var a;const o=(t=>e.filter((e=>e.schema===t.name)).length>=t.max)(i);return Object(g.jsx)(n.EuiContextMenuItem,{key:`${i.name}_${i.title}`,"data-test-subj":`visEditorAdd_${t}_${i.title}`,disabled:s&&p(i,o),onClick:()=>(e=>{l(!1),r(e)})(i),toolTipContent:null!==(a=i.tooltip)&&void 0!==a?a:o?f:void 0},i.title)}))}))))}function Tt({formIsTouched:e,groupName:t,lastParentPipelineAggTitle:i,metricAggs:o,state:s,schemas:l=[],addSchema:d,setAggParamValue:p,setStateParamValue:m,onAggTypeChange:f,onToggleEnableAgg:b,removeAgg:v,reorderAggs:x,setTouched:y,setValidity:_,timeRange:O}){const S=h.AggGroupLabels[t],k=l.map((e=>e.name)),A=Object(a.useMemo)((()=>s.data.aggs.aggs.filter((e=>e.schema&&k.includes(e.schema)))||[]),[s.data.aggs,k]),T={max:0,count:A.length};l.forEach((e=>{T.max+=e.max}));const[C,M]=Object(a.useReducer)(xt,A,jt),R=i&&t===h.AggGroupNames.Buckets&&!A.length?u.i18n.translate("visDefaultEditor.buckets.mustHaveBucketErrorMessage",{defaultMessage:'Add a bucket with "Date Histogram" or "Histogram" aggregation.',description:"Date Histogram and Histogram should not be translated"}):void 0,I=!R&&Object.values(C).every((e=>e.valid)),L=function(e){const t=Object.values(e).filter((e=>!e.valid));return!Object(c.isEmpty)(t)&&t.every((e=>e.touched))}(C),P=Object(a.useMemo)((()=>t===h.AggGroupNames.Metrics&&1===E(A)),[t,A]);Object(a.useEffect)((()=>{y(L)}),[L,y]),Object(a.useEffect)((()=>{e&&!L&&Object.keys(C).map((([e])=>{M({type:vt.TOUCHED,payload:!0,aggId:e})}))}),[e]),Object(a.useEffect)((()=>{_(`aggGroup__${t}`,I)}),[t,I,_]);const D=Object(a.useCallback)((({source:e,destination:t})=>{e&&t&&x(A[e.index],A[t.index])}),[x,A]);return Object(g.jsx)(n.EuiDragDropContext,{onDragEnd:D},Object(g.jsx)(n.EuiPanel,{"data-test-subj":`${t}AggGroup`,paddingSize:"s"},Object(g.jsx)(n.EuiTitle,{size:"xs"},Object(g.jsx)("h3",null,S)),Object(g.jsx)(n.EuiSpacer,{size:"s"}),R&&Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiFormErrorText,{"data-test-subj":"bucketsError"},R),Object(g.jsx)(n.EuiSpacer,{size:"s"})),Object(g.jsx)(n.EuiDroppable,{droppableId:`agg_group_dnd_${t}`},Object(g.jsx)(r.a.Fragment,null,A.map(((e,a)=>Object(g.jsx)(n.EuiDraggable,{key:e.id,index:a,draggableId:`agg_group_dnd_${t}_${e.id}`,customDragHandle:!0},(r=>Object(g.jsx)(kt,{agg:e,aggIndex:a,aggIsTooLow:w(e,a,A,l),dragHandleProps:r.dragHandleProps||null,formIsTouched:!!C[e.id]&&C[e.id].touched,groupName:t,isDraggable:T.count>1,isLastBucket:t===h.AggGroupNames.Buckets&&a===A.length-1,isRemovable:j(e,A,l),isDisabled:"metric"===e.schema&&P,lastParentPipelineAggTitle:i,metricAggs:o,state:s,setAggParamValue:p,setStateParamValue:m,onAggTypeChange:f,onToggleEnableAgg:b,removeAgg:v,setAggsState:M,schemas:l,timeRange:O}))))))),T.max>T.count&&Object(g.jsx)(At,{group:A,groupName:t,schemas:l,stats:T,addSchema:d})))}function Ct({dispatch:e,formIsTouched:t,metricAggs:i,schemas:o,state:s,setTouched:l,setValidity:u,setStateValue:p,timeRange:m}){const f=Object(a.useMemo)((()=>Object(c.findLast)(i,(({type:e})=>e.subtype===h.search.aggs.parentPipelineType))),[i]),b=f&&f.type.title,x=Object(a.useCallback)((t=>e((e=>({type:v.ADD_NEW_AGG,payload:{schema:e}}))(t))),[e]),j=Object(a.useCallback)((t=>e(((e,t)=>({type:v.REMOVE_AGG,payload:{aggId:e,schemas:t}}))(t,o.all||[]))),[e,o]),E=Object(a.useCallback)(((...t)=>e(((e,t)=>({type:v.REORDER_AGGS,payload:{sourceAgg:e,destinationAgg:t}}))(...t))),[e]),w=Object(a.useCallback)(((...t)=>e(((e,t,i)=>({type:v.SET_AGG_PARAM_VALUE,payload:{aggId:e,paramName:t,value:i}}))(...t))),[e]),y=Object(a.useCallback)(((...t)=>e(((e,t)=>({type:v.CHANGE_AGG_TYPE,payload:{aggId:e,value:t}}))(...t))),[e]),_=Object(a.useCallback)(((...t)=>e(((e,t)=>({type:v.TOGGLE_ENABLED_AGG,payload:{aggId:e,enabled:t}}))(...t))),[e]),O={addSchema:x,formIsTouched:t,lastParentPipelineAggTitle:b,metricAggs:i,state:s,reorderAggs:E,setAggParamValue:w,setStateParamValue:p,onAggTypeChange:y,onToggleEnableAgg:_,setValidity:u,setTouched:l,removeAgg:j};return Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(Tt,d()({groupName:h.AggGroupNames.Metrics,schemas:o.metrics},O)),Object(g.jsx)(n.EuiSpacer,{size:"s"}),Object(g.jsx)(Tt,d()({groupName:h.AggGroupNames.Buckets,schemas:o.buckets,timeRange:m},O)))}function Mt({embeddableHandler:e,isCollapsed:t,onClickCollapse:i,uiState:o,vis:s,isLinkedSearch:l,eventEmitter:m,savedSearch:f,timeRange:b}){const[h,x]=Object(a.useState)(!1),[j,E]=S(s,m),{formState:w,setTouched:y,setValidity:A,resetValidity:T}=function(){const[e,t]=Object(a.useState)(_),i=Object(a.useCallback)(((e,i)=>{t((t=>{const a={...t.validity,[e]:i};return{...t,validity:a,invalid:Object.values(a).some((e=>!e))}}))}),[]),r=Object(a.useCallback)((()=>{t(_)}),[]);return{formState:e,setValidity:i,setTouched:Object(a.useCallback)((e=>{t((t=>({...t,touched:e})))}),[]),resetValidity:r}}(),[M,R]=(({type:e})=>{const[t,i]=Object(a.useState)((()=>{var t,i;const a=[...null!==(t=e.schemas.buckets)&&void 0!==t&&t.length||null!==(i=e.schemas.metrics)&&void 0!==i&&i.length?[{name:"data",title:u.i18n.translate("visDefaultEditor.sidebar.tabs.dataLabel",{defaultMessage:"Data"}),editor:Ct}]:[],...!e.editorConfig.optionTabs&&e.editorConfig.optionsTemplate?[{name:"options",title:u.i18n.translate("visDefaultEditor.sidebar.tabs.optionsLabel",{defaultMessage:"Options"}),editor:e.editorConfig.optionsTemplate}]:e.editorConfig.optionTabs];return a[0].isSelected=!0,a}));return[t,Object(a.useCallback)((e=>{i((t=>t.map((t=>({...t,isSelected:t.name===e})))))}),[])]})(s),I=Object(a.useMemo)((()=>j.data.aggs?j.data.aggs.getResponseAggs():[]),[j.data.aggs]),L=(s.type.schemas.metrics||[]).map((e=>e.name)),P=Object(a.useMemo)((()=>I.filter((e=>e.schema&&L.includes(e.schema)))),[I,L]),D=Object(a.useMemo)((()=>I.some((e=>"histogram"===e.type.name))),[I]),F=Object(a.useCallback)((e=>{A("visOptions",e)}),[A]),B=Object(a.useCallback)(((e,t)=>{!Object(c.isEqual)(j.params[e],t)&&E(((e,t)=>({type:v.SET_STATE_PARAM_VALUE,payload:{paramName:e,value:t}}))(e,t))}),[E,j.params]),N=Object(a.useCallback)((()=>{!w.invalid&&h?(s.setState({...s.serialize(),params:j.params,data:{aggs:j.data.aggs?j.data.aggs.aggs.map((e=>e.toJSON())):[]}}),e.reload(),m.emit("dirtyStateChange",{isDirty:!1}),y(!1)):y(!0)}),[s,j,w.invalid,y,h,m,e]),V=Object(a.useCallback)((e=>{e.ctrlKey&&e.key===n.keys.ENTER&&(e.preventDefault(),e.stopPropagation(),N())}),[N]);Object(a.useEffect)((()=>{const e=({isDirty:e})=>{x(e),e||T()};return m.on("dirtyStateChange",e),()=>{m.off("dirtyStateChange",e)}}),[T,m]),Object(a.useEffect)((()=>{const e=()=>E(O(s));return m.on("updateEditor",e),()=>{m.off("updateEditor",e)}}),[E,s,m]);const z={dispatch:E,formIsTouched:w.touched,metricAggs:P,state:j,schemas:s.type.schemas,setValidity:A,setTouched:y,setStateValue:B},G={aggs:j.data.aggs,hasHistogramAgg:D,stateParams:j.params,vis:s,uiState:o,setValue:B,setValidity:F,setTouched:y};return Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(n.EuiFlexGroup,{className:"visEditorSidebar",direction:"column",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},Object(g.jsx)(n.EuiFlexItem,null,Object(g.jsx)("form",{className:"visEditorSidebar__form",name:"visualizeEditor",onKeyDownCapture:V},s.type.requiresSearch&&Object(g.jsx)(C,{isLinkedSearch:l,savedSearch:f,vis:s,eventEmitter:m}),M.length>1&&Object(g.jsx)(p,{optionTabs:M,setSelectedTab:R}),M.map((({editor:e,name:t,isSelected:i=!1})=>Object(g.jsx)("div",{key:t,className:"visEditorSidebar__config "+(i?"":"visEditorSidebar__config-isHidden")},Object(g.jsx)(e,d()({isTabSelected:i},"data"===t?z:G,{timeRange:b}))))))),Object(g.jsx)(n.EuiFlexItem,{grow:!1},Object(g.jsx)(k,{applyChanges:N,dispatch:E,isDirty:h,isTouched:w.touched,isInvalid:w.invalid,vis:s}))),Object(g.jsx)(n.EuiButtonIcon,{"aria-expanded":!t,"aria-label":u.i18n.translate("visDefaultEditor.sidebar.collapseButtonAriaLabel",{defaultMessage:"Toggle sidebar"}),className:"visEditor__collapsibleSidebarButton","data-test-subj":"collapseSideBarButton",color:"text",iconType:t?"menuLeft":"menuRight",onClick:i}))}const Rt=Object(a.memo)(Mt);var It=i(11);const Lt=new s.Storage(window.localStorage);function Pt({core:e,data:t,vis:i,uiState:s,timeRange:l,filters:d,query:c,embeddableHandler:u,eventEmitter:p,linked:m,savedSearch:f}){const b=Object(a.useRef)(null),[h,v]=Object(a.useState)(!1),x=Object(a.useCallback)((()=>{v((e=>!e))}),[]),j=Object(a.useCallback)((()=>{}),[]);Object(a.useEffect)((()=>{if(b.current)return u.render(b.current).then((()=>{setTimeout((async()=>{p.emit("embeddableRendered")}))})),()=>u.destroy()}),[u,p]),Object(a.useEffect)((()=>{u.updateInput({timeRange:l,filters:d,query:c})}),[u,l,d,c]);const E=Object(It.b)(i.type.editorConfig.defaultSize);return Object(g.jsx)(e.i18n.Context,null,Object(g.jsx)(o.KibanaContextProvider,{services:{appName:"vis_default_editor",storage:Lt,data:t,...e}},Object(g.jsx)(n.EuiResizableContainer,{className:"visEditor--default",onMouseLeave:j},((e,t)=>Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(e,{className:"visEditor__visualization",initialSize:100-E,minSize:"25%",paddingSize:"none",wrapperProps:{className:"visEditor__visualization__wrapper "+(h?"visEditor__visualization__wrapper-expanded":"")}},Object(g.jsx)("div",{className:"visEditor__canvas",ref:b,"data-shared-items-container":!0})),Object(g.jsx)(t,{className:"visEditor__resizer "+(h?"visEditor__resizer-isHidden":"")}),Object(g.jsx)(e,{initialSize:E,minSize:h?"0":"350px",paddingSize:"none",wrapperProps:{className:"visEditor__collapsibleSidebar "+(h?"visEditor__collapsibleSidebar-isClosed":"")}},Object(g.jsx)(Rt,{embeddableHandler:u,isCollapsed:h,onClickCollapse:x,vis:i,uiState:s,isLinkedSearch:m,savedSearch:f,timeRange:l,eventEmitter:p})))))))}}])]);